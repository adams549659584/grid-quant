import{f as se,d as ne,r as A,c as ce,o as le,E as ie,a as re,b as de,e as Fe,g as x,h as o,i as L,j as Q,k as O,w as q,F as W,l as X,m as j,n as U,p as fe,q as $,t as C,u as he,_ as pe,s as ve}from"./vendor.f8914156.js";const ge=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))f(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const E of d.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&f(E)}).observe(document,{childList:!0,subtree:!0});function n(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerpolicy&&(d.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?d.credentials="include":i.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function f(i){if(i.ep)return;i.ep=!0;const d=n(i);fetch(i.href,d)}};ge();var me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArlJREFUWEfFl1nITVEUx3/fE1GmF7wrGUvIECFCyVhEhpJSHlBIeEHCCzIkb5QhooyliBAZ4sWc8iZjMhXFC/2/9ql11rfPPfue6+uuOnXP2Wv47bWHtW4LTZaWJsenCkAXYCTQMzyaw8fw3Ad+1DOpVIDuwCpgNDC5JMBV4C6wH/haBpMCsAJYDfQtc+bGXwH7gEO17MoAzgGz6gzs1c8Ds4t81AJQ+ro1GDwz/wZoGdtIEcBJYP5/Cp65OQUs8D5jAJuBLUbxLHAAGAdMB4YmgMn+FrASmGP09X2rtfcAQ4A7QCejNAG4ad4F+MU8GuphHhtgPHDD2L4DhgHvs28eIJb6RcCJhFnHVBYCx91ALgsWQGQPI17WAbsrAqwFdjnbN0Af4I++W4BNwHan/BuYFJalCsMY4BrQwRkvAw57AK2V1syKZrCnSmRjsyaSQe0p7a1cBl4A/VywwcDTBgEGAU+cj5dAfw+gne0vC11E3xsE6AroIrKiS04nJ5eBn+74aby9AH4BnT2AToBOgpX2WoJHwHAPcBRY7ABUgnULNiK6DVWarRwDlniAjcAOp/gBGAu8rkig834b6OXsdeR3eoCZgEqnF5XkpRU2ozbfkYJSrBJ/wQPoXZ3MqAiEvus8P0jMxIhwf6iD8nIvdFat330tyO7u58A8YABw2nh4FshVWvXbysBQwpVJ/S6SXG2JleMroe/LICa6TXQRUJCYCHZujeDqF6fY8RiAar6CSC4D0wCVYF3Tj8NG/VQQRMdWOkUyA7hUBqBxbbrWYgFMBZSVVPlboKglPePHavWE6oT3BoPrwNvQ+68vIYkBRIPLT1lXrNSrLdefkEzKbCyAlkMlvs3MU51JrzewHNgAdEyAFoCKzzbgIKCeolDKZmMNM5BcUxnxrKwp8OeUTVMPQIq/unWaDvAPFJGAIVce/UQAAAAASUVORK5CYII=";function T(u,l){return se(u,l||{timeout:1e3*5,jsonpCallback:"cb"}).then(n=>n.json())}function Pe(u,l=1,n=10){const f=`https://searchapi.eastmoney.com/api/Info/Search?appid=el1902262&type=14&token=CCSDCZSDCXYMYZYYSYYXSMDDSMDHHDJT&and14=MultiMatch/Name,Code,PinYin/${u}/true&returnfields14=Name,Code,PinYin,MarketType,JYS,MktNum,JYS4App,MktNum4App,ID,Classify,IsExactMatch,SecurityType,SecurityTypeName&pageIndex14=${l}&pageSize14=${n}&isAssociation14=false1642753371132`;return T(f)}function z(u){return u&&u.data&&u.data.klines&&(u.data.klineDatas=u.data.klines.map(l=>{const n=l.split(","),f=n[0];let i=f,d="";return f.includes(" ")&&([i,d]=f.split(" ")),{dateStr:i,timeStr:d,openPrice:parseFloat(n[1]),closePrice:parseFloat(n[2]),highPrice:parseFloat(n[3]),lowPrice:parseFloat(n[4])}})),u}async function Ce(u){const l=`http://push2his.eastmoney.com/api/qt/stock/kline/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&beg=0&end=20500101&ut=fa5fd1943c7b386f172d6893dbfba10b&rtntype=6&secid=${u}&klt=5&fqt=1
  `,n=await T(l);return z(n)}async function Ee(u,l){const n=`http://push2his.eastmoney.com/api/qt/stock/kline/get?secid=${u}&ut=fa5fd1943c7b386f172d6893dbfba10b&fields1=f1,f2,f3,f4,f5,f6&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&klt=101&fqt=0&end=20500101&lmt=${l}&_=${Date.now()}`,f=await T(n);return z(f)}function Ae(u,l){const n={"y+":u.getFullYear(),"M+":u.getMonth()+1,"d+":u.getDate(),"h+":u.getHours()%12==0?12:u.getHours()%12,"H+":u.getHours(),"m+":u.getMinutes(),"s+":u.getSeconds(),"q+":Math.floor((u.getMonth()+3)/3),"f+":u.getMilliseconds()};for(const f in n)new RegExp("("+f+")").test(l)&&(l=l.replace(RegExp.$1,n[f].toString().padStart(RegExp.$1.length,"0")));return l}function ye(u){return Ae(new Date,u)}function c(u=1,l=3){const n=Math.pow(10,l);return Math.round(u*n)/n}function G(u,l,n){const f=l-n,i=(u*2+n+l)/4,d=c(f+i),E=c(i*2-n),_=c(i*2-l),B=c(i-f);return{highSalePrice:d,highSaleRate:c((d/u-1)*100,2),firstSalePrice:E,firstSaleRate:c((E/u-1)*100,2),firstBuyPrice:_,firstBuyRate:c((u/_-1)*100,2),lowBuyPrice:B,lowBuyRate:c((u/B-1)*100,2)}}const _e={class:"container"},De=o("header",{class:"header"},[o("h1",{class:"flex-center"},[o("span",null,"\u4EF7\u683C\u9884\u6D4B"),o("a",{class:"flex-center",href:"https://github.com/adams549659584/grid-quant",target:"_blank"},[o("img",{class:"github-link",src:me,alt:"https://github.com/adams549659584/grid-quant"})])])],-1),Se={class:"main"},$e={class:"search"},Be=j("\u56DE\u6D4B"),ke={key:0,class:"next-price-box"},xe={class:"cus-row cus-row-header"},we={class:"cus-column"},be={class:"stock-name"},Me={class:"cus-row cus-row-header"},Ne=o("div",{class:"cus-column"},"\u64CD\u4F5C",-1),Re={class:"cus-column"},Ie={class:"cus-row high-sale-price"},Ve=o("div",{class:"cus-column"},"\u6781\u9650\u83B7\u5229\u4F4D",-1),Ye={class:"cus-column"},Je={class:"cus-row first-sale-price"},He=o("div",{class:"cus-column"},"\u7B2C\u4E00\u538B\u529B\u4F4D",-1),Oe={class:"cus-column"},Ue={class:"cus-row first-buy-price"},Te=o("div",{class:"cus-column"},"\u7B2C\u4E00\u652F\u6491\u4F4D",-1),Ge={class:"cus-column"},Ke={class:"cus-row low-buy-price"},Le=o("div",{class:"cus-column"},"\u6781\u9650\u6284\u5E95\u4F4D",-1),Qe={class:"cus-column"},qe={class:"cus-row"},We=o("div",{class:"cus-column"},"\u632F\u5E45",-1),Xe={class:"cus-column"},je=o("footer",{class:"footer"},[o("div",null,[o("p",{class:"text"},[j(" MIT Licensed | Copyright \xA9 2022 "),o("a",{href:"https://github.com/adams549659584",target:"_blank"},"adams549659584")])])],-1),ze=ne({setup(u){const l="history_search_results",n=A(!0),f=A(""),i=A(),d=A(),E=A(!1),_=.008,B=A(5),b=A(1e3),M=A(400),s=A(0),r=A(1e5),K=A(0),w=ce(()=>f.value?f.value.split("_")[0]:""),Z=async()=>{I()},ee=async F=>{if(F){E.value=!0;const a=await Pe(F);i.value=a.Data||[],E.value=!1}else i.value=[]},N=()=>{const F=localStorage.getItem(l);return F?JSON.parse(F):[]},te=F=>{let a=N();const h=a.findIndex(P=>F.market===P.market&&F.code===P.code&&F.name===P.name);h>-1?a[h]=F:a=[F,...a],d.value=a,localStorage.setItem(l,JSON.stringify(a))},ue=async()=>{if(!!w.value)return R(w.value)},R=async F=>{const a=await Ee(F,2);if(a&&a.data&&a.data.klineDatas&&a.data.klineDatas.length===2){const h=a.data.klineDatas,P=ye("yyyy-MM-dd"),y=!n.value||h[1].dateStr===P&&new Date().getHours()<15?h[0]:h[1],g=G(y.closePrice,y.highPrice,y.lowPrice),t=c((g.highSalePrice-g.lowBuyPrice)/((g.highSalePrice+g.lowBuyPrice)/2),2);c(t/B.value),te({market:a.data.market,code:a.data.code,name:a.data.name,nowPrice:h[1],nextPrice:g})}else U.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},ae=F=>{let a=N();a=a.filter(h=>!(F.market===h.market&&F.code===h.code&&F.name===h.name)),d.value=a,localStorage.setItem(l,JSON.stringify(a))},oe=async()=>{if(!w.value){U.error("\u8BF7\u5148\u9009\u62E9\u80A1\u7968/\u57FA\u91D1");return}const F=fe.service({lock:!0}),a=await Ce(w.value);if(a&&a.data&&a.data.klineDatas&&a.data.klineDatas.length>0){s.value=0,r.value=1e5,console.log(`\u521D\u59CB\u6301\u4ED3 ${s.value} \uFF0C  \u4F59\u989D \uFFE5${r.value}`);const h=a.data.klineDatas,P=h[0];let y=P.dateStr,g=P.highPrice,t=P.lowPrice,k=P.closePrice,v=G(k,g,t),V=c((v.firstSalePrice-v.firstBuyPrice)/((v.firstSalePrice+v.firstBuyPrice)/2),2),D=c(V/B.value);D<_&&(D=_);let Y=P.openPrice,S=Y;for(let J=1;J<h.length;J++){const e=h[J];if(y===e.dateStr?(e.highPrice>g&&(g=e.highPrice),e.lowPrice<t&&(t=e.lowPrice),k=e.closePrice):(console.log(`\u5B9E\u9645 : highPrice : ${g} , lowPrice : ${t} , closePrice : ${k}`),y=e.dateStr,console.log(`${y} :`),Y=e.openPrice,S=Y,v=G(k,g,t),console.log("\u9884\u6D4B : ",v),g=e.highPrice,t=e.lowPrice,V=c((v.firstSalePrice-v.firstBuyPrice)/((v.firstSalePrice+v.firstBuyPrice)/2),2),D=c(V/B.value),D<_&&(D=_),console.log(`\u7F51\u683C\u5E45\u5EA6 : ${(D*100).toFixed(2)}%`)),s.value<b.value&&e.openPrice>v.firstBuyPrice&&e.openPrice<v.firstSalePrice){const p=b.value-s.value,m=c(p*e.openPrice,2);S=e.openPrice,s.value=c(s.value+p),r.value=c(r.value-m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A \u4F4E\u4E8E\u6700\u5C0F\u6301\u4ED3\uFF0C\uFFE5${e.openPrice} \u4E70\u5165 ${p} \u80A1 , \u652F\u51FA \uFFE5${m} \uFF0C \u6301\u4ED3 ${s.value} \uFF0C \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C \uFFE5${(e.closePrice*s.value+r.value).toFixed(2)}`)}const H=e.openPrice/S-1;if(Math.abs(H)>D){if(s.value>0&&e.openPrice>v.highSalePrice){const p=s.value,m=c(p*e.openPrice,2);S=e.openPrice,s.value=c(s.value-p),r.value=c(r.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u76C8\u5356\u51FA ${p} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${s.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*s.value+r.value).toFixed(2)}`)}else if(s.value>0&&e.openPrice<v.lowBuyPrice){const p=s.value,m=c(p*e.openPrice,2);S=e.openPrice,s.value=c(s.value-p),r.value=c(r.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u635F\u5356\u51FA ${p} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${s.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*s.value+r.value).toFixed(2)}`)}else if(H>0&&s.value-M.value>=b.value){const p=M.value,m=c(p*e.openPrice,2);S=e.openPrice,s.value=c(s.value-p),r.value=c(r.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u5356\u51FA ${p} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${s.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*s.value+r.value).toFixed(2)}`)}else if(H<0&&e.openPrice>v.lowBuyPrice){const p=M.value,m=c(p*e.openPrice,2);if(r.value<m){console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u4F59\u989D \uFFE5${r.value} \u4E0D\u8DB3\u4EE5\u8D2D\u4E70\u672C\u6B21\u7F51\u683C\uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*s.value+r.value).toFixed(2)}`);continue}S=e.openPrice,s.value=c(s.value+p),r.value=c(r.value-m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u4E70\u5165 ${p} \u80A1 , \u652F\u51FA \uFFE5${m} \uFF0C \u6301\u4ED3 ${s.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*s.value+r.value).toFixed(2)}`)}}}console.log(`\u5F53\u524D\u6301\u4ED3 ${s.value} \uFF0C  \u4F59\u989D \uFFE5${r.value}\uFF0C  \u5E02\u503C \uFFE5${(h[h.length-1].closePrice*s.value+r.value).toFixed(2)}`),F.close()}else U.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},I=async()=>{d.value=N(),d.value.length>0?d.value.forEach(F=>R(`${F.market}.${F.code}`)):["1.000001","1.000300","1.000905","0.399006"].forEach(F=>R(F)),K.value=setTimeout(()=>{I()},1e3*30)};return(()=>{I()})(),le(()=>{clearTimeout(K.value)}),(F,a)=>{const h=ie,P=re,y=de,g=Fe;return $(),x("div",_e,[De,o("main",Se,[o("header",$e,[new Date().getHours()>=15?($(),L(h,{key:0,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),"inline-prompt":"","active-text":"\u9884","inactive-text":"\u56DE",onChange:Z},null,8,["modelValue"])):Q("",!0),O(y,{class:"stock-selelct",size:"large",modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=t=>f.value=t),clearable:!0,filterable:"",remote:"","reserve-keyword":"",placeholder:"\u8BF7\u9009\u62E9\u80A1\u7968/\u57FA\u91D1","remote-method":ee,loading:E.value,onChange:ue},{default:q(()=>[($(!0),x(W,null,X(i.value,t=>($(),L(P,{key:`${t.MktNum}.${t.Code}_${t.Name}`,label:`${t.Code} ${t.Name} ${t.SecurityTypeName}`,value:`${t.MktNum}.${t.Code}_${t.Name}`},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),O(g,{class:"btn-backtesting",size:"large",type:"danger",onClick:oe},{default:q(()=>[Be]),_:1})]),o("main",null,[d.value?($(),x("div",ke,[($(!0),x(W,null,X(d.value,(t,k)=>($(),x("div",{key:k,class:"cus-table next-price"},[o("div",xe,[o("div",we,[o("span",be,C(`${t.code} ${t.name}`),1),O(g,{class:"btn-delete",type:"danger",icon:he(pe),circle:"",onClick:v=>ae(t)},null,8,["icon","onClick"])])]),o("div",Me,[Ne,o("div",Re,"\u4EF7\u683C("+C(t.nowPrice.closePrice.toFixed(3))+")",1)]),o("div",Ie,[Ve,o("div",Ye,C(t.nextPrice.highSalePrice.toFixed(3))+"(+"+C(t.nextPrice.highSaleRate)+"%)",1)]),o("div",Je,[He,o("div",Oe,C(t.nextPrice.firstSalePrice.toFixed(3))+"(+"+C(t.nextPrice.firstSaleRate)+"%)",1)]),o("div",Ue,[Te,o("div",Ge,C(t.nextPrice.firstBuyPrice.toFixed(3))+"(-"+C(t.nextPrice.firstBuyRate)+"%)",1)]),o("div",Ke,[Le,o("div",Qe,C(t.nextPrice.lowBuyPrice.toFixed(3))+"(-"+C(t.nextPrice.lowBuyRate)+"%)",1)]),o("div",qe,[We,o("div",Xe,C((t.nextPrice.firstSaleRate+t.nextPrice.firstBuyRate).toFixed(2))+"% - "+C((t.nextPrice.highSaleRate+t.nextPrice.lowBuyRate).toFixed(2))+"% ",1)])]))),128))])):Q("",!0)])]),je])}}});ve(ze).mount("#app");
