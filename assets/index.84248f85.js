import{f as de,d as Fe,r as y,o as fe,E as he,a as ve,c as S,b as u,u as W,e as pe,g as X,w as j,v as ge,h as Pe,F as z,i as Z,j as ee,k as me,l as te,m as U,n as Ce,p as E,t as A,_ as ye,q as Ae,s as Ee}from"./vendor.99899ac2.js";const _e=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))f(i);new MutationObserver(i=>{for(const F of i)if(F.type==="childList")for(const p of F.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&f(p)}).observe(document,{childList:!0,subtree:!0});function c(i){const F={};return i.integrity&&(F.integrity=i.integrity),i.referrerpolicy&&(F.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?F.credentials="include":i.crossorigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function f(i){if(i.ep)return;i.ep=!0;const F=c(i);fetch(i.href,F)}};_e();var Se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArlJREFUWEfFl1nITVEUx3/fE1GmF7wrGUvIECFCyVhEhpJSHlBIeEHCCzIkb5QhooyliBAZ4sWc8iZjMhXFC/2/9ql11rfPPfue6+uuOnXP2Wv47bWHtW4LTZaWJsenCkAXYCTQMzyaw8fw3Ad+1DOpVIDuwCpgNDC5JMBV4C6wH/haBpMCsAJYDfQtc+bGXwH7gEO17MoAzgGz6gzs1c8Ds4t81AJQ+ro1GDwz/wZoGdtIEcBJYP5/Cp65OQUs8D5jAJuBLUbxLHAAGAdMB4YmgMn+FrASmGP09X2rtfcAQ4A7QCejNAG4ad4F+MU8GuphHhtgPHDD2L4DhgHvs28eIJb6RcCJhFnHVBYCx91ALgsWQGQPI17WAbsrAqwFdjnbN0Af4I++W4BNwHan/BuYFJalCsMY4BrQwRkvAw57AK2V1syKZrCnSmRjsyaSQe0p7a1cBl4A/VywwcDTBgEGAU+cj5dAfw+gne0vC11E3xsE6AroIrKiS04nJ5eBn+74aby9AH4BnT2AToBOgpX2WoJHwHAPcBRY7ABUgnULNiK6DVWarRwDlniAjcAOp/gBGAu8rkig834b6OXsdeR3eoCZgEqnF5XkpRU2ozbfkYJSrBJ/wQPoXZ3MqAiEvus8P0jMxIhwf6iD8nIvdFat330tyO7u58A8YABw2nh4FshVWvXbysBQwpVJ/S6SXG2JleMroe/LICa6TXQRUJCYCHZujeDqF6fY8RiAar6CSC4D0wCVYF3Tj8NG/VQQRMdWOkUyA7hUBqBxbbrWYgFMBZSVVPlboKglPePHavWE6oT3BoPrwNvQ+68vIYkBRIPLT1lXrNSrLdefkEzKbCyAlkMlvs3MU51JrzewHNgAdEyAFoCKzzbgIKCeolDKZmMNM5BcUxnxrKwp8OeUTVMPQIq/unWaDvAPFJGAIVce/UQAAAAASUVORK5CYII=";function G(s,r){return de(s,r||{timeout:1e3*5,jsonpCallback:"cb"}).then(c=>c.json())}function De(s,r=1,c=10){const f=`https://searchapi.eastmoney.com/api/Info/Search?appid=el1902262&type=14&token=CCSDCZSDCXYMYZYYSYYXSMDDSMDHHDJT&and14=MultiMatch/Name,Code,PinYin/${s}/true&returnfields14=Name,Code,PinYin,MarketType,JYS,MktNum,JYS4App,MktNum4App,ID,Classify,IsExactMatch,SecurityType,SecurityTypeName&pageIndex14=${r}&pageSize14=${c}&isAssociation14=false1642753371132`;return G(f)}function ue(s){return s&&s.data&&s.data.klines&&(s.data.klineDatas=s.data.klines.map(r=>{const c=r.split(","),f=c[0];let i=f,F="";return f.includes(" ")&&([i,F]=f.split(" ")),{dateStr:i,timeStr:F,openPrice:parseFloat(c[1]),closePrice:parseFloat(c[2]),highPrice:parseFloat(c[3]),lowPrice:parseFloat(c[4])}})),s}async function $e(s){const r=`https://push2his.eastmoney.com/api/qt/stock/kline/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&beg=0&end=20500101&ut=fa5fd1943c7b386f172d6893dbfba10b&rtntype=6&secid=${s}&klt=5&fqt=1
  `,c=await G(r);return ue(c)}async function Be(s,r){const c=`https://push2his.eastmoney.com/api/qt/stock/kline/get?secid=${s}&ut=fa5fd1943c7b386f172d6893dbfba10b&fields1=f1,f2,f3,f4,f5,f6&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&klt=101&fqt=0&end=20500101&lmt=${r}&_=${Date.now()}`,f=await G(c);return ue(f)}function ke(s,r){const c={"y+":s.getFullYear(),"M+":s.getMonth()+1,"d+":s.getDate(),"h+":s.getHours()%12==0?12:s.getHours()%12,"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),"f+":s.getMilliseconds()};for(const f in c)new RegExp("("+f+")").test(r)&&(r=r.replace(RegExp.$1,c[f].toString().padStart(RegExp.$1.length,"0")));return r}function se(s){return ke(new Date,s)}function l(s=1,r=3){const c=Math.pow(10,r);return Math.round(s*c)/c}function K(s,r,c){const f=r-c,i=(s*2+c+r)/4,F=l(f+i),p=l(i*2-c),B=l(i*2-r),k=l(i-f);return{highSalePrice:F,highSaleRate:l((F/s-1)*100,2),firstSalePrice:p,firstSaleRate:l((p/s-1)*100,2),firstBuyPrice:B,firstBuyRate:l((s/B-1)*100,2),lowBuyPrice:k,lowBuyRate:l((s/k-1)*100,2)}}const xe={class:"container"},we=u("header",{class:"header"},[u("h1",{class:"flex-center"},[u("span",null,"\u4EF7\u683C\u9884\u6D4B"),u("a",{class:"flex-center",href:"https://github.com/adams549659584/grid-quant",target:"_blank"},[u("img",{class:"github-link",src:Se,alt:"https://github.com/adams549659584/grid-quant"})])])],-1),be={class:"main"},Me={class:"search"},Ne={class:"stock-search"},Re={key:0,class:"stock-search-result"},Ie=["onClick"],Ye={key:1,class:"stock-search-result"},Je=u("li",null,"\u6682\u65E0\u76F8\u5173\u80A1\u7968/\u57FA\u91D1",-1),Ve=[Je],He={key:2,class:"stock-search-result"},Te=u("li",null,"\u8F93\u5165\u80A1\u7968/\u57FA\u91D1 \u7F16\u7801/\u7B80\u62FC/\u5168\u62FC/\u4E2D\u6587",-1),Oe=[Te],Ue=te("\u56DE\u6D4B"),Ge={key:0,class:"next-price-box"},Ke={class:"cus-row cus-row-header"},Le={class:"cus-column"},Qe={class:"stock-name"},qe={class:"cus-row cus-row-header"},We=u("div",{class:"cus-column"},"\u64CD\u4F5C",-1),Xe={class:"cus-row high-sale-price"},je=u("div",{class:"cus-column"},"\u6781\u9650\u83B7\u5229\u4F4D",-1),ze={class:"cus-column"},Ze={class:"cus-row first-sale-price"},et=u("div",{class:"cus-column"},"\u7B2C\u4E00\u538B\u529B\u4F4D",-1),tt={class:"cus-column"},ut={class:"cus-row first-buy-price"},st=u("div",{class:"cus-column"},"\u7B2C\u4E00\u652F\u6491\u4F4D",-1),ot={class:"cus-column"},at={class:"cus-row low-buy-price"},nt=u("div",{class:"cus-column"},"\u6781\u9650\u6284\u5E95\u4F4D",-1),ct={class:"cus-column"},it={class:"cus-row"},lt=u("div",{class:"cus-column"},"\u632F\u5E45",-1),rt={class:"cus-column"},dt=u("footer",{class:"footer"},[u("div",null,[u("p",{class:"text"},[te(" MIT Licensed | Copyright \xA9 2022 "),u("a",{href:"https://github.com/adams549659584",target:"_blank"},"adams549659584")])])],-1),Ft=Fe({setup(s){const r="history_search_results",c=y(!0),f=y(!1),i=y(""),F=y(),p=y(),B=y(!1),k=Number(se("Hmm")),L=k>=930&&k<=1500,oe=window.screen.width>500&&!L,x=.008,b=y(5),M=y(1e3),N=y(400),a=y(0),d=y(1e5),Q=y(0),R=y(""),q=n=>{n?f.value=n:setTimeout(()=>{f.value=n},300)},ae=async()=>{J()},ne=async()=>{if(i.value){B.value=!0;const n=await De(i.value);F.value=n.Data||[],B.value=!1}else F.value=[]},I=()=>{const n=localStorage.getItem(r);return n?JSON.parse(n):[]},ce=n=>{let o=I();const h=o.findIndex(C=>n.market===C.market&&n.code===C.code&&n.name===C.name);h>-1?o[h]=n:o=[n,...o],p.value=o,localStorage.setItem(r,JSON.stringify(o))},ie=async n=>(console.log("selectChange : ",n),R.value=n,Y(n)),Y=async n=>{const o=await Be(n,2);if(o&&o.data&&o.data.klineDatas&&o.data.klineDatas.length===2){const h=o.data.klineDatas,C=se("yyyy-MM-dd"),t=!c.value||h[1].dateStr===C&&new Date().getHours()<15?h[0]:h[1],g=K(t.closePrice,t.highPrice,t.lowPrice),_=l((g.highSalePrice-g.lowBuyPrice)/((g.highSalePrice+g.lowBuyPrice)/2),2);l(_/b.value),ce({market:o.data.market,code:o.data.code,name:o.data.name,nowPrice:h[1],nextPrice:g})}else U.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},le=n=>{let o=I();o=o.filter(h=>!(n.market===h.market&&n.code===h.code&&n.name===h.name)),p.value=o,localStorage.setItem(r,JSON.stringify(o))},re=async()=>{if(!R.value){U.error("\u8BF7\u5148\u9009\u62E9\u80A1\u7968/\u57FA\u91D1");return}const n=Ce.service({lock:!0}),o=await $e(R.value);if(o&&o.data&&o.data.klineDatas&&o.data.klineDatas.length>0){a.value=0,d.value=1e5,console.log(`\u521D\u59CB\u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${d.value}`);const h=o.data.klineDatas,C=h[0];let t=C.dateStr,g=C.highPrice,_=C.lowPrice,w=C.closePrice,P=K(w,g,_),V=l((P.firstSalePrice-P.firstBuyPrice)/((P.firstSalePrice+P.firstBuyPrice)/2),2),D=l(V/b.value);D<x&&(D=x);let H=C.openPrice,$=H;for(let T=1;T<h.length;T++){const e=h[T];if(t===e.dateStr?(e.highPrice>g&&(g=e.highPrice),e.lowPrice<_&&(_=e.lowPrice),w=e.closePrice):(console.log(`\u5B9E\u9645 : highPrice : ${g} , lowPrice : ${_} , closePrice : ${w}`),t=e.dateStr,console.log(`${t} :`),H=e.openPrice,$=H,P=K(w,g,_),console.log("\u9884\u6D4B : ",P),g=e.highPrice,_=e.lowPrice,V=l((P.firstSalePrice-P.firstBuyPrice)/((P.firstSalePrice+P.firstBuyPrice)/2),2),D=l(V/b.value),D<x&&(D=x),console.log(`\u7F51\u683C\u5E45\u5EA6 : ${(D*100).toFixed(2)}%`)),a.value<M.value&&e.openPrice>P.firstBuyPrice&&e.openPrice<P.firstSalePrice){const v=M.value-a.value,m=l(v*e.openPrice,2);$=e.openPrice,a.value=l(a.value+v),d.value=l(d.value-m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A \u4F4E\u4E8E\u6700\u5C0F\u6301\u4ED3\uFF0C\uFFE5${e.openPrice} \u4E70\u5165 ${v} \u80A1 , \u652F\u51FA \uFFE5${m} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C \u4F59\u989D \uFFE5${d.value} \uFF0C \u5E02\u503C \uFFE5${(e.closePrice*a.value+d.value).toFixed(2)}`)}const O=e.openPrice/$-1;if(Math.abs(O)>D){if(a.value>0&&e.openPrice>P.highSalePrice){const v=a.value,m=l(v*e.openPrice,2);$=e.openPrice,a.value=l(a.value-v),d.value=l(d.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u76C8\u5356\u51FA ${v} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${d.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*a.value+d.value).toFixed(2)}`)}else if(a.value>0&&e.openPrice<P.lowBuyPrice){const v=a.value,m=l(v*e.openPrice,2);$=e.openPrice,a.value=l(a.value-v),d.value=l(d.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u635F\u5356\u51FA ${v} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${d.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*a.value+d.value).toFixed(2)}`)}else if(O>0&&a.value-N.value>=M.value){const v=N.value,m=l(v*e.openPrice,2);$=e.openPrice,a.value=l(a.value-v),d.value=l(d.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u5356\u51FA ${v} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${d.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*a.value+d.value).toFixed(2)}`)}else if(O<0&&e.openPrice>P.lowBuyPrice){const v=N.value,m=l(v*e.openPrice,2);if(d.value<m){console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u4F59\u989D \uFFE5${d.value} \u4E0D\u8DB3\u4EE5\u8D2D\u4E70\u672C\u6B21\u7F51\u683C\uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*a.value+d.value).toFixed(2)}`);continue}$=e.openPrice,a.value=l(a.value+v),d.value=l(d.value-m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u4E70\u5165 ${v} \u80A1 , \u652F\u51FA \uFFE5${m} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${d.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*a.value+d.value).toFixed(2)}`)}}}console.log(`\u5F53\u524D\u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${d.value}\uFF0C  \u5E02\u503C \uFFE5${(h[h.length-1].closePrice*a.value+d.value).toFixed(2)}`),n.close()}else U.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},J=async()=>{p.value=I(),p.value.length>0?p.value.forEach(n=>Y(`${n.market}.${n.code}`)):["1.000001","1.000300","1.000905","0.399006"].forEach(n=>Y(n)),L&&(Q.value=setTimeout(()=>{J()},1e3*30))};return(()=>{J()})(),fe(()=>{clearTimeout(Q.value)}),(n,o)=>{const h=he,C=ve;return E(),S("div",xe,[we,u("main",be,[u("header",Me,[W(oe)?(E(),pe(h,{key:0,modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=t=>c.value=t),"inline-prompt":"","active-text":"\u9884","inactive-text":"\u56DE",onChange:ae},null,8,["modelValue"])):X("",!0),u("div",Ne,[j(u("input",{class:"stock-search-input",type:"text",placeholder:"\u8BF7\u8F93\u5165\u80A1\u7968/\u57FA\u91D1\u4EE3\u7801","onUpdate:modelValue":o[1]||(o[1]=t=>i.value=t),onFocus:o[2]||(o[2]=t=>q(!0)),onBlur:o[3]||(o[3]=t=>q(!1)),onInput:ne},null,544),[[ge,i.value]]),j(u("div",null,[F.value&&F.value.length>0?(E(),S("ul",Re,[(E(!0),S(z,null,Z(F.value,t=>(E(),S("li",{key:`${t.MktNum}.${t.Code}_${t.Name}`,onClick:g=>ie(`${t.MktNum}.${t.Code}`)},A(`${t.Code} ${t.Name} ${t.SecurityTypeName}`),9,Ie))),128))])):i.value.length>0?(E(),S("ul",Ye,Ve)):(E(),S("ul",He,Oe))],512),[[Pe,f.value]])]),ee(C,{class:"btn-backtesting",size:"large",type:"danger",onClick:re},{default:me(()=>[Ue]),_:1})]),u("main",null,[p.value?(E(),S("div",Ge,[(E(!0),S(z,null,Z(p.value,(t,g)=>(E(),S("div",{key:g,class:"cus-table next-price"},[u("div",Ke,[u("div",Le,[u("span",Qe,A(`${t.code} ${t.name}`),1),ee(C,{class:"btn-delete",type:"danger",icon:W(ye),circle:"",onClick:_=>le(t)},null,8,["icon","onClick"])])]),u("div",qe,[We,u("div",{class:Ae(["cus-column close-price",{"close-price-red":t.nowPrice.closePrice>(t.nextPrice.firstSalePrice+t.nextPrice.firstBuyPrice)/2}])},"\u4EF7\u683C("+A(t.nowPrice.closePrice.toFixed(3))+")",3)]),u("div",Xe,[je,u("div",ze,A(t.nextPrice.highSalePrice.toFixed(3))+"(+"+A(t.nextPrice.highSaleRate)+"%)",1)]),u("div",Ze,[et,u("div",tt,A(t.nextPrice.firstSalePrice.toFixed(3))+"(+"+A(t.nextPrice.firstSaleRate)+"%)",1)]),u("div",ut,[st,u("div",ot,A(t.nextPrice.firstBuyPrice.toFixed(3))+"(-"+A(t.nextPrice.firstBuyRate)+"%)",1)]),u("div",at,[nt,u("div",ct,A(t.nextPrice.lowBuyPrice.toFixed(3))+"(-"+A(t.nextPrice.lowBuyRate)+"%)",1)]),u("div",it,[lt,u("div",rt,A((t.nextPrice.firstSaleRate+t.nextPrice.firstBuyRate).toFixed(2))+"% - "+A((t.nextPrice.highSaleRate+t.nextPrice.lowBuyRate).toFixed(2))+"% ",1)])]))),128))])):X("",!0)])]),dt])}}});Ee(Ft).mount("#app");
