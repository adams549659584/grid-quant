import{f as pe,d as ge,r as P,c as me,o as Pe,E as ye,a as Ce,b as _,e as u,g as Ee,h as te,w as q,v as Ae,i as ue,F as M,j as R,u as N,k as W,l as _e,m as Se,n as C,t as E,p as De,_ as ke,q as $e,s as Be,x as se,y as xe,z as we}from"./vendor.07feca6f.js";const be=function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))f(c);new MutationObserver(c=>{for(const F of c)if(F.type==="childList")for(const p of F.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&f(p)}).observe(document,{childList:!0,subtree:!0});function l(c){const F={};return c.integrity&&(F.integrity=c.integrity),c.referrerpolicy&&(F.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?F.credentials="include":c.crossorigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function f(c){if(c.ep)return;c.ep=!0;const F=l(c);fetch(c.href,F)}};be();var Me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArlJREFUWEfFl1nITVEUx3/fE1GmF7wrGUvIECFCyVhEhpJSHlBIeEHCCzIkb5QhooyliBAZ4sWc8iZjMhXFC/2/9ql11rfPPfue6+uuOnXP2Wv47bWHtW4LTZaWJsenCkAXYCTQMzyaw8fw3Ad+1DOpVIDuwCpgNDC5JMBV4C6wH/haBpMCsAJYDfQtc+bGXwH7gEO17MoAzgGz6gzs1c8Ds4t81AJQ+ro1GDwz/wZoGdtIEcBJYP5/Cp65OQUs8D5jAJuBLUbxLHAAGAdMB4YmgMn+FrASmGP09X2rtfcAQ4A7QCejNAG4ad4F+MU8GuphHhtgPHDD2L4DhgHvs28eIJb6RcCJhFnHVBYCx91ALgsWQGQPI17WAbsrAqwFdjnbN0Af4I++W4BNwHan/BuYFJalCsMY4BrQwRkvAw57AK2V1syKZrCnSmRjsyaSQe0p7a1cBl4A/VywwcDTBgEGAU+cj5dAfw+gne0vC11E3xsE6AroIrKiS04nJ5eBn+74aby9AH4BnT2AToBOgpX2WoJHwHAPcBRY7ABUgnULNiK6DVWarRwDlniAjcAOp/gBGAu8rkig834b6OXsdeR3eoCZgEqnF5XkpRU2ozbfkYJSrBJ/wQPoXZ3MqAiEvus8P0jMxIhwf6iD8nIvdFat330tyO7u58A8YABw2nh4FshVWvXbysBQwpVJ/S6SXG2JleMroe/LICa6TXQRUJCYCHZujeDqF6fY8RiAar6CSC4D0wCVYF3Tj8NG/VQQRMdWOkUyA7hUBqBxbbrWYgFMBZSVVPlboKglPePHavWE6oT3BoPrwNvQ+68vIYkBRIPLT1lXrNSrLdefkEzKbCyAlkMlvs3MU51JrzewHNgAdEyAFoCKzzbgIKCeolDKZmMNM5BcUxnxrKwp8OeUTVMPQIq/unWaDvAPFJGAIVce/UQAAAAASUVORK5CYII=";function j(s,d){return pe(s,d||{timeout:1e3*5,jsonpCallback:"cb"}).then(l=>l.json())}function Re(s,d=1,l=10){const f=`https://searchapi.eastmoney.com/api/Info/Search?appid=el1902262&type=14&token=CCSDCZSDCXYMYZYYSYYXSMDDSMDHHDJT&and14=MultiMatch/Name,Code,PinYin/${s}/true&returnfields14=Name,Code,PinYin,MarketType,JYS,MktNum,JYS4App,MktNum4App,ID,Classify,IsExactMatch,SecurityType,SecurityTypeName&pageIndex14=${d}&pageSize14=${l}&isAssociation14=false1642753371132`;return j(f)}function ae(s){return s&&s.data&&s.data.klines&&(s.data.klineDatas=s.data.klines.map(d=>{const l=d.split(","),f=l[0];let c=f,F="";return f.includes(" ")&&([c,F]=f.split(" ")),{dateStr:c,timeStr:F,openPrice:parseFloat(l[1]),closePrice:parseFloat(l[2]),highPrice:parseFloat(l[3]),lowPrice:parseFloat(l[4])}})),s}async function Ne(s){const d=`https://push2his.eastmoney.com/api/qt/stock/kline/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&beg=0&end=20500101&ut=fa5fd1943c7b386f172d6893dbfba10b&rtntype=6&secid=${s}&klt=5&fqt=1
  `,l=await j(d);return ae(l)}async function Ie(s,d){const l=`https://push2his.eastmoney.com/api/qt/stock/kline/get?secid=${s}&ut=fa5fd1943c7b386f172d6893dbfba10b&fields1=f1,f2,f3,f4,f5,f6&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&klt=101&fqt=0&end=20500101&lmt=${d}&_=${Date.now()}`,f=await j(l);return ae(f)}function Ye(s,d){const l={"y+":s.getFullYear(),"M+":s.getMonth()+1,"d+":s.getDate(),"h+":s.getHours()%12==0?12:s.getHours()%12,"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),"f+":s.getMilliseconds()};for(const f in l)new RegExp("("+f+")").test(d)&&(d=d.replace(RegExp.$1,l[f].toString().padStart(RegExp.$1.length,"0")));return d}function ne(s){return Ye(new Date,s)}function r(s=1,d=3){const l=Math.pow(10,d);return Math.round(s*l)/l}function X(s,d,l){const f=d-l,c=(s*2+l+d)/4,F=r(f+c),p=r(c*2-l),B=r(c*2-d),x=r(c-f);return{highSalePrice:F,highSaleRate:r((F/s-1)*100,2),firstSalePrice:p,firstSaleRate:r((p/s-1)*100,2),firstBuyPrice:B,firstBuyRate:r((s/B-1)*100,2),lowBuyPrice:x,lowBuyRate:r((s/x-1)*100,2)}}const Je=u("header",null,[u("h1",{class:"flex-center"},[u("span",{class:"title"},"\u4EF7\u683C\u9884\u6D4B"),u("a",{class:"cursor-pointer",href:"https://github.com/adams549659584/grid-quant",target:"_blank"},[u("img",{src:Me,alt:"https://github.com/adams549659584/grid-quant"})])])],-1),Ve={class:"flex-center space-x-4"},He={class:"absolute"},Te={key:0,class:"search-hotkey"},Oe=["onClick"],Ue={key:1,class:"search-hotkey"},Le=u("li",{class:"search-hotkey-items"},"\u6682\u65E0\u76F8\u5173\u80A1\u7968/\u57FA\u91D1",-1),Ge=[Le],Ke={key:2,class:"search-hotkey"},Qe=u("li",{class:"search-hotkey-items"},"\u8F93\u5165\u80A1\u7968/\u57FA\u91D1 \u7F16\u7801/\u7B80\u62FC/\u5168\u62FC/\u4E2D\u6587",-1),qe=[Qe],We={key:0,class:"flex-center justify-around text-xl font-bold"},je={class:"row p-2"},Xe={class:"flex-1 text-center truncate"},ze={class:"row"},Ze=u("div",{class:"column"},"\u64CD\u4F5C",-1),et={class:"row bg-red-400"},tt=u("div",{class:"column"},"\u6781\u9650\u83B7\u5229\u4F4D",-1),ut={class:"column"},st={class:"row bg-red-300"},at=u("div",{class:"column"},"\u7B2C\u4E00\u538B\u529B\u4F4D",-1),nt={class:"column"},ot={class:"row bg-green-300"},it=u("div",{class:"column"},"\u7B2C\u4E00\u652F\u6491\u4F4D",-1),lt={class:"column"},ct={class:"row bg-green-400"},rt=u("div",{class:"column"},"\u6781\u9650\u6284\u5E95\u4F4D",-1),dt={class:"column"},Ft={class:"row"},ft=u("div",{class:"column"},"\u632F\u5E45",-1),ht={class:"column"},vt={class:"backtesting-log-bg"},pt={class:"backtesting-log-box"},gt={class:"flex-center p-4"},mt=Be("\u770B\u5B8C\u4E86"),Pt=u("footer",null,[u("div",{class:"p-4 text-gray-400"},[u("p",{class:"flex-center space-x-2"},[u("span",null,"MIT Licensed | Copyright \xA9 2022"),u("a",{href:"https://github.com/adams549659584",target:"_blank"},"adams549659584")])])],-1),yt=ge({setup(s){const d="history_search_results",l=P(!0),f=P(!1),c=P(""),F=P(),p=P(),B=P(!1),x=Number(ne("Hmm")),z=x>=930&&x<=1500,oe=!z,ie=me(()=>{if(!p.value||p.value.length===0)return 0;const a=p.value.length,n=window.screen.width;return n>=1536?5-a%5:n>=1280?4-a%4:n>=1024?3-a%3:n>=768?2-a%2:0}),b=.008,I=P(5),Y=P(1e3),J=P(400),o=P(0),i=P(1e5),Z=P(0),le=P(""),V=P(!1),S=P([]),ee=a=>{a?f.value=a:setTimeout(()=>{f.value=a},300)},ce=async()=>{O()},re=async()=>{if(c.value){B.value=!0;const a=await Re(c.value);F.value=a.Data||[],B.value=!1}else F.value=[]},H=()=>{const a=localStorage.getItem(d);return a?JSON.parse(a):[]},de=a=>{let n=H();const v=n.findIndex(m=>a.market===m.market&&a.code===m.code&&a.name===m.name);v>-1?n[v]=a:n=[a,...n],p.value=n,localStorage.setItem(d,JSON.stringify(n))},Fe=async a=>(S.value.push("selectChange : ",a),le.value=a,T(a)),T=async a=>{const n=await Ie(a,2);if(n&&n.data&&n.data.klineDatas&&n.data.klineDatas.length===2){const v=n.data.klineDatas,m=ne("yyyy-MM-dd"),t=!l.value||v[1].dateStr===m&&new Date().getHours()<15?v[0]:v[1],A=X(t.closePrice,t.highPrice,t.lowPrice),D=r((A.highSalePrice-A.lowBuyPrice)/((A.highSalePrice+A.lowBuyPrice)/2),2);r(D/I.value),de({market:n.data.market,code:n.data.code,name:n.data.name,nowPrice:v[1],nextPrice:A})}else se.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},fe=a=>{let n=H();n=n.filter(v=>!(a.market===v.market&&a.code===v.code&&a.name===v.name)),p.value=n,localStorage.setItem(d,JSON.stringify(n))},he=async a=>{const n=xe.service({lock:!0}),v=await Ne(a);if(n.close(),v&&v.data&&v.data.klineDatas&&v.data.klineDatas.length>0){V.value=!0,S.value=[],o.value=0,i.value=1e5,S.value.push(`\u521D\u59CB\u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value}`);const m=v.data.klineDatas,t=m[0];let A=t.dateStr,D=t.highPrice,w=t.lowPrice,U=t.closePrice,y=X(U,D,w),L=r((y.firstSalePrice-y.firstBuyPrice)/((y.firstSalePrice+y.firstBuyPrice)/2),2),$=r(L/I.value);$<b&&($=b);let G=t.openPrice,k=G;for(let K=1;K<m.length;K++){const e=m[K];if(A===e.dateStr?(e.highPrice>D&&(D=e.highPrice),e.lowPrice<w&&(w=e.lowPrice),U=e.closePrice):(A=e.dateStr,G=e.openPrice,k=G,y=X(U,D,w),D=e.highPrice,w=e.lowPrice,L=r((y.firstSalePrice-y.firstBuyPrice)/((y.firstSalePrice+y.firstBuyPrice)/2),2),$=r(L/I.value),$<b&&($=b)),o.value<Y.value&&e.openPrice>y.firstBuyPrice&&e.openPrice<y.firstSalePrice){const h=Y.value-o.value,g=r(h*e.openPrice,2);if(k=e.openPrice,i.value<g){S.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u4F59\u989D \uFFE5${i.value} \u4E0D\u8DB3\u4EE5\u5EFA\u4ED3${h}\uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*o.value+i.value).toFixed(2)}`);continue}o.value=r(o.value+h),i.value=r(i.value-g),S.value.push(`${e.dateStr} ${e.timeStr}\uFF1A \u4F4E\u4E8E\u6700\u5C0F\u6301\u4ED3\uFF0C\uFFE5${e.openPrice} \u4E70\u5165 ${h} \u80A1 , \u652F\u51FA \uFFE5${g} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C \uFFE5${(e.closePrice*o.value+i.value).toFixed(2)}`)}const Q=e.openPrice/k-1;if(Math.abs(Q)>$){if(o.value>0&&e.openPrice>y.highSalePrice){const h=o.value,g=r(h*e.openPrice,2);k=e.openPrice,o.value=r(o.value-h),i.value=r(i.value+g),S.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u76C8\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${g} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*o.value+i.value).toFixed(2)}`)}else if(o.value>0&&e.openPrice<y.lowBuyPrice){const h=o.value,g=r(h*e.openPrice,2);k=e.openPrice,o.value=r(o.value-h),i.value=r(i.value+g),S.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u635F\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${g} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*o.value+i.value).toFixed(2)}`)}else if(Q>0&&o.value-J.value>=Y.value){const h=J.value,g=r(h*e.openPrice,2);k=e.openPrice,o.value=r(o.value-h),i.value=r(i.value+g),S.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${g} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*o.value+i.value).toFixed(2)}`)}else if(Q<0&&e.openPrice>y.lowBuyPrice){const h=J.value,g=r(h*e.openPrice,2);if(i.value<g){S.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u4F59\u989D \uFFE5${i.value} \u4E0D\u8DB3\u4EE5\u8D2D\u4E70\u672C\u6B21\u7F51\u683C\uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*o.value+i.value).toFixed(2)}`);continue}k=e.openPrice,o.value=r(o.value+h),i.value=r(i.value-g),S.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u4E70\u5165 ${h} \u80A1 , \u652F\u51FA \uFFE5${g} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*o.value+i.value).toFixed(2)}`)}}}S.value.push(`\u5F53\u524D\u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value}\uFF0C  \u5E02\u503C \uFFE5${(m[m.length-1].closePrice*o.value+i.value).toFixed(2)}`)}else se.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},ve=async()=>{V.value=!1},O=async()=>{p.value=H(),p.value.length>0?p.value.forEach(a=>T(`${a.market}.${a.code}`)):["1.510050","0.159602","1.561990","1.510500","1.512100","1.516970","0.159928","1.512670","1.516110","1.512000","1.512480","1.515790","0.159867","0.159790","1.512760","1.516100","0.159997","0.159755","1.512980","0.159828","0.159883","1.513050","1.513330","0.159967","0.159745","1.512200","0.159825","0.159996","0.159992","1.515250","1.516780","1.511220","1.511260","0.159905","1.511380","1.513500","0.161834","1.501022","0.159981","1.512890"].forEach(a=>T(a)),z&&(Z.value=setTimeout(()=>{O()},1e3*30))};return(()=>{O()})(),Pe(()=>{clearTimeout(Z.value)}),(a,n)=>{const v=ye,m=Ce;return C(),_("div",null,[Je,u("main",null,[u("header",Ve,[oe?(C(),Ee(v,{key:0,modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=t=>l.value=t),"inline-prompt":"","active-text":"\u9884","inactive-text":"\u56DE",onChange:ce},null,8,["modelValue"])):te("",!0),u("div",null,[q(u("input",{class:"input-search",type:"text",placeholder:"\u8BF7\u8F93\u5165\u80A1\u7968/\u57FA\u91D1\u4EE3\u7801","onUpdate:modelValue":n[1]||(n[1]=t=>c.value=t),onFocus:n[2]||(n[2]=t=>ee(!0)),onBlur:n[3]||(n[3]=t=>ee(!1)),onInput:re},null,544),[[Ae,c.value]]),q(u("div",He,[F.value&&F.value.length>0?(C(),_("ul",Te,[(C(!0),_(M,null,R(F.value,t=>(C(),_("li",{class:"search-hotkey-items",key:`${t.MktNum}.${t.Code}_${t.Name}`,onClick:A=>Fe(`${t.MktNum}.${t.Code}`)},E(`${t.Code} ${t.Name} ${t.SecurityTypeName}`),9,Oe))),128))])):c.value.length>0?(C(),_("ul",Ue,Ge)):(C(),_("ul",Ke,qe))],512),[[ue,f.value]])])]),u("main",null,[p.value?(C(),_("div",We,[(C(!0),_(M,null,R(p.value,(t,A)=>(C(),_("div",{class:"next-price-box",key:A},[u("div",je,[u("span",Xe,E(`${t.code} ${t.name}`),1),W(m,{class:"w-min",type:"primary",icon:N(De),circle:"",onClick:D=>he(`${t.market}.${t.code}`)},null,8,["icon","onClick"]),W(m,{class:"w-min",type:"danger",icon:N(ke),circle:"",onClick:D=>fe(t)},null,8,["icon","onClick"])]),u("div",ze,[Ze,u("div",{class:$e(["column close-price-green",{"close-price-red":t.nowPrice.closePrice>=(t.nextPrice.firstSalePrice+t.nextPrice.firstBuyPrice)/2}])},"\u4EF7\u683C("+E(t.nowPrice.closePrice.toFixed(3))+")",3)]),u("div",et,[tt,u("div",ut,E(t.nextPrice.highSalePrice.toFixed(3))+"(+"+E(t.nextPrice.highSaleRate)+"%)",1)]),u("div",st,[at,u("div",nt,E(t.nextPrice.firstSalePrice.toFixed(3))+"(+"+E(t.nextPrice.firstSaleRate)+"%)",1)]),u("div",ot,[it,u("div",lt,E(t.nextPrice.firstBuyPrice.toFixed(3))+"(-"+E(t.nextPrice.firstBuyRate)+"%)",1)]),u("div",ct,[rt,u("div",dt,E(t.nextPrice.lowBuyPrice.toFixed(3))+"(-"+E(t.nextPrice.lowBuyRate)+"%)",1)]),u("div",Ft,[ft,u("div",ht,E((t.nextPrice.firstSaleRate+t.nextPrice.firstBuyRate).toFixed(2))+"% - "+E((t.nextPrice.highSaleRate+t.nextPrice.lowBuyRate).toFixed(2))+"%",1)])]))),128)),(C(!0),_(M,null,R(N(ie),t=>(C(),_("div",{class:"next-price-box invisible",key:t}))),128)),q(u("div",vt,[u("div",pt,[(C(!0),_(M,null,R(S.value,(t,A)=>(C(),_("div",{class:"backtesting-log-item",key:A},E(t),1))),128)),u("div",gt,[W(m,{type:"danger",icon:N(Se),onClick:ve},{default:_e(()=>[mt]),_:1},8,["icon"])])])],512),[[ue,V.value]])])):te("",!0)])]),Pt])}}});we(yt).mount("#app");
