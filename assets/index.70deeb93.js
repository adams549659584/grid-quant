import{f as pe,d as ge,r as P,o as me,E as Pe,a as Ce,c as S,b as u,e as ye,g as te,w as G,v as Ee,h as ue,F as K,i as Q,j as q,k as Ae,u as W,l as se,m as _,t as y,n as _e,_ as Se,p as De,q as ke,s as ae,x as $e,y as Be}from"./vendor.431193f7.js";const xe=function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))f(l);new MutationObserver(l=>{for(const F of l)if(F.type==="childList")for(const g of F.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&f(g)}).observe(document,{childList:!0,subtree:!0});function i(l){const F={};return l.integrity&&(F.integrity=l.integrity),l.referrerpolicy&&(F.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?F.credentials="include":l.crossorigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function f(l){if(l.ep)return;l.ep=!0;const F=i(l);fetch(l.href,F)}};xe();var be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArlJREFUWEfFl1nITVEUx3/fE1GmF7wrGUvIECFCyVhEhpJSHlBIeEHCCzIkb5QhooyliBAZ4sWc8iZjMhXFC/2/9ql11rfPPfue6+uuOnXP2Wv47bWHtW4LTZaWJsenCkAXYCTQMzyaw8fw3Ad+1DOpVIDuwCpgNDC5JMBV4C6wH/haBpMCsAJYDfQtc+bGXwH7gEO17MoAzgGz6gzs1c8Ds4t81AJQ+ro1GDwz/wZoGdtIEcBJYP5/Cp65OQUs8D5jAJuBLUbxLHAAGAdMB4YmgMn+FrASmGP09X2rtfcAQ4A7QCejNAG4ad4F+MU8GuphHhtgPHDD2L4DhgHvs28eIJb6RcCJhFnHVBYCx91ALgsWQGQPI17WAbsrAqwFdjnbN0Af4I++W4BNwHan/BuYFJalCsMY4BrQwRkvAw57AK2V1syKZrCnSmRjsyaSQe0p7a1cBl4A/VywwcDTBgEGAU+cj5dAfw+gne0vC11E3xsE6AroIrKiS04nJ5eBn+74aby9AH4BnT2AToBOgpX2WoJHwHAPcBRY7ABUgnULNiK6DVWarRwDlniAjcAOp/gBGAu8rkig834b6OXsdeR3eoCZgEqnF5XkpRU2ozbfkYJSrBJ/wQPoXZ3MqAiEvus8P0jMxIhwf6iD8nIvdFat330tyO7u58A8YABw2nh4FshVWvXbysBQwpVJ/S6SXG2JleMroe/LICa6TXQRUJCYCHZujeDqF6fY8RiAar6CSC4D0wCVYF3Tj8NG/VQQRMdWOkUyA7hUBqBxbbrWYgFMBZSVVPlboKglPePHavWE6oT3BoPrwNvQ+68vIYkBRIPLT1lXrNSrLdefkEzKbCyAlkMlvs3MU51JrzewHNgAdEyAFoCKzzbgIKCeolDKZmMNM5BcUxnxrKwp8OeUTVMPQIq/unWaDvAPFJGAIVce/UQAAAAASUVORK5CYII=";function X(s,d){return pe(s,d||{timeout:1e3*5,jsonpCallback:"cb"}).then(i=>i.json())}function we(s,d=1,i=10){const f=`https://searchapi.eastmoney.com/api/Info/Search?appid=el1902262&type=14&token=CCSDCZSDCXYMYZYYSYYXSMDDSMDHHDJT&and14=MultiMatch/Name,Code,PinYin/${s}/true&returnfields14=Name,Code,PinYin,MarketType,JYS,MktNum,JYS4App,MktNum4App,ID,Classify,IsExactMatch,SecurityType,SecurityTypeName&pageIndex14=${d}&pageSize14=${i}&isAssociation14=false1642753371132`;return X(f)}function ne(s){return s&&s.data&&s.data.klines&&(s.data.klineDatas=s.data.klines.map(d=>{const i=d.split(","),f=i[0];let l=f,F="";return f.includes(" ")&&([l,F]=f.split(" ")),{dateStr:l,timeStr:F,openPrice:parseFloat(i[1]),closePrice:parseFloat(i[2]),highPrice:parseFloat(i[3]),lowPrice:parseFloat(i[4])}})),s}async function Me(s){const d=`https://push2his.eastmoney.com/api/qt/stock/kline/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&beg=0&end=20500101&ut=fa5fd1943c7b386f172d6893dbfba10b&rtntype=6&secid=${s}&klt=5&fqt=1
  `,i=await X(d);return ne(i)}async function Ne(s,d){const i=`https://push2his.eastmoney.com/api/qt/stock/kline/get?secid=${s}&ut=fa5fd1943c7b386f172d6893dbfba10b&fields1=f1,f2,f3,f4,f5,f6&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&klt=101&fqt=0&end=20500101&lmt=${d}&_=${Date.now()}`,f=await X(i);return ne(f)}function Re(s,d){const i={"y+":s.getFullYear(),"M+":s.getMonth()+1,"d+":s.getDate(),"h+":s.getHours()%12==0?12:s.getHours()%12,"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),"f+":s.getMilliseconds()};for(const f in i)new RegExp("("+f+")").test(d)&&(d=d.replace(RegExp.$1,i[f].toString().padStart(RegExp.$1.length,"0")));return d}function oe(s){return Re(new Date,s)}function r(s=1,d=3){const i=Math.pow(10,d);return Math.round(s*i)/i}function j(s,d,i){const f=d-i,l=(s*2+i+d)/4,F=r(f+l),g=r(l*2-i),B=r(l*2-d),x=r(l-f);return{highSalePrice:F,highSaleRate:r((F/s-1)*100,2),firstSalePrice:g,firstSaleRate:r((g/s-1)*100,2),firstBuyPrice:B,firstBuyRate:r((s/B-1)*100,2),lowBuyPrice:x,lowBuyRate:r((s/x-1)*100,2)}}const Ie={class:"container"},Ye=u("header",{class:"header"},[u("h1",{class:"flex-center"},[u("span",null,"\u4EF7\u683C\u9884\u6D4B"),u("a",{class:"flex-center",href:"https://github.com/adams549659584/grid-quant",target:"_blank"},[u("img",{class:"github-link",src:be,alt:"https://github.com/adams549659584/grid-quant"})])])],-1),Je={class:"main"},Ve={class:"search"},He={class:"stock-search"},Te={key:0,class:"stock-search-result"},Oe=["onClick"],Ue={key:1,class:"stock-search-result"},Le=u("li",null,"\u6682\u65E0\u76F8\u5173\u80A1\u7968/\u57FA\u91D1",-1),Ge=[Le],Ke={key:2,class:"stock-search-result"},Qe=u("li",null,"\u8F93\u5165\u80A1\u7968/\u57FA\u91D1 \u7F16\u7801/\u7B80\u62FC/\u5168\u62FC/\u4E2D\u6587",-1),qe=[Qe],We={key:0,class:"next-price-box"},Xe={class:"cus-row cus-row-header"},je={class:"cus-column"},ze={class:"stock-name"},Ze={class:"cus-row cus-row-header"},et=u("div",{class:"cus-column"},"\u64CD\u4F5C",-1),tt={class:"cus-row high-sale-price"},ut=u("div",{class:"cus-column"},"\u6781\u9650\u83B7\u5229\u4F4D",-1),st={class:"cus-column"},at={class:"cus-row first-sale-price"},nt=u("div",{class:"cus-column"},"\u7B2C\u4E00\u538B\u529B\u4F4D",-1),ot={class:"cus-column"},ct={class:"cus-row first-buy-price"},it=u("div",{class:"cus-column"},"\u7B2C\u4E00\u652F\u6491\u4F4D",-1),lt={class:"cus-column"},rt={class:"cus-row low-buy-price"},dt=u("div",{class:"cus-column"},"\u6781\u9650\u6284\u5E95\u4F4D",-1),Ft={class:"cus-column"},ft={class:"cus-row"},ht=u("div",{class:"cus-column"},"\u632F\u5E45",-1),vt={class:"cus-column"},pt={class:"backtesting-log-bg"},gt={class:"backtesting-log-container"},mt=se("\u770B\u5B8C\u4E86 "),Pt=u("footer",{class:"footer"},[u("div",null,[u("p",{class:"text"},[se(" MIT Licensed | Copyright \xA9 2022 "),u("a",{href:"https://github.com/adams549659584",target:"_blank"},"adams549659584")])])],-1),Ct=ge({setup(s){const d="history_search_results",i=P(!0),f=P(!1),l=P(""),F=P(),g=P(),B=P(!1),x=Number(oe("Hmm")),z=x>=930&&x<=1500,ce=!z,w=.008,M=P(5),N=P(1e3),R=P(400),a=P(0),c=P(1e5),Z=P(0),ie=P(""),I=P(!1),A=P([]),ee=n=>{n?f.value=n:setTimeout(()=>{f.value=n},300)},le=async()=>{V()},re=async()=>{if(l.value){B.value=!0;const n=await we(l.value);F.value=n.Data||[],B.value=!1}else F.value=[]},Y=()=>{const n=localStorage.getItem(d);return n?JSON.parse(n):[]},de=n=>{let o=Y();const v=o.findIndex(m=>n.market===m.market&&n.code===m.code&&n.name===m.name);v>-1?o[v]=n:o=[n,...o],g.value=o,localStorage.setItem(d,JSON.stringify(o))},Fe=async n=>(A.value.push("selectChange : ",n),ie.value=n,J(n)),J=async n=>{const o=await Ne(n,2);if(o&&o.data&&o.data.klineDatas&&o.data.klineDatas.length===2){const v=o.data.klineDatas,m=oe("yyyy-MM-dd"),t=!i.value||v[1].dateStr===m&&new Date().getHours()<15?v[0]:v[1],E=j(t.closePrice,t.highPrice,t.lowPrice),D=r((E.highSalePrice-E.lowBuyPrice)/((E.highSalePrice+E.lowBuyPrice)/2),2);r(D/M.value),de({market:o.data.market,code:o.data.code,name:o.data.name,nowPrice:v[1],nextPrice:E})}else ae.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},fe=n=>{let o=Y();o=o.filter(v=>!(n.market===v.market&&n.code===v.code&&n.name===v.name)),g.value=o,localStorage.setItem(d,JSON.stringify(o))},he=async n=>{const o=$e.service({lock:!0}),v=await Me(n);if(o.close(),v&&v.data&&v.data.klineDatas&&v.data.klineDatas.length>0){I.value=!0,A.value=[],a.value=0,c.value=1e5,A.value.push(`\u521D\u59CB\u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${c.value}`);const m=v.data.klineDatas,t=m[0];let E=t.dateStr,D=t.highPrice,b=t.lowPrice,H=t.closePrice,C=j(H,D,b),T=r((C.firstSalePrice-C.firstBuyPrice)/((C.firstSalePrice+C.firstBuyPrice)/2),2),$=r(T/M.value);$<w&&($=w);let O=t.openPrice,k=O;for(let U=1;U<m.length;U++){const e=m[U];if(E===e.dateStr?(e.highPrice>D&&(D=e.highPrice),e.lowPrice<b&&(b=e.lowPrice),H=e.closePrice):(E=e.dateStr,O=e.openPrice,k=O,C=j(H,D,b),D=e.highPrice,b=e.lowPrice,T=r((C.firstSalePrice-C.firstBuyPrice)/((C.firstSalePrice+C.firstBuyPrice)/2),2),$=r(T/M.value),$<w&&($=w)),a.value<N.value&&e.openPrice>C.firstBuyPrice&&e.openPrice<C.firstSalePrice){const h=N.value-a.value,p=r(h*e.openPrice,2);if(k=e.openPrice,c.value<p){A.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u4F59\u989D \uFFE5${c.value} \u4E0D\u8DB3\u4EE5\u5EFA\u4ED3${h}\uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*a.value+c.value).toFixed(2)}`);continue}a.value=r(a.value+h),c.value=r(c.value-p),A.value.push(`${e.dateStr} ${e.timeStr}\uFF1A \u4F4E\u4E8E\u6700\u5C0F\u6301\u4ED3\uFF0C\uFFE5${e.openPrice} \u4E70\u5165 ${h} \u80A1 , \u652F\u51FA \uFFE5${p} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C \u4F59\u989D \uFFE5${c.value} \uFF0C \u5E02\u503C \uFFE5${(e.closePrice*a.value+c.value).toFixed(2)}`)}const L=e.openPrice/k-1;if(Math.abs(L)>$){if(a.value>0&&e.openPrice>C.highSalePrice){const h=a.value,p=r(h*e.openPrice,2);k=e.openPrice,a.value=r(a.value-h),c.value=r(c.value+p),A.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u76C8\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${p} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${c.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*a.value+c.value).toFixed(2)}`)}else if(a.value>0&&e.openPrice<C.lowBuyPrice){const h=a.value,p=r(h*e.openPrice,2);k=e.openPrice,a.value=r(a.value-h),c.value=r(c.value+p),A.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u635F\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${p} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${c.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*a.value+c.value).toFixed(2)}`)}else if(L>0&&a.value-R.value>=N.value){const h=R.value,p=r(h*e.openPrice,2);k=e.openPrice,a.value=r(a.value-h),c.value=r(c.value+p),A.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${p} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${c.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*a.value+c.value).toFixed(2)}`)}else if(L<0&&e.openPrice>C.lowBuyPrice){const h=R.value,p=r(h*e.openPrice,2);if(c.value<p){A.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u4F59\u989D \uFFE5${c.value} \u4E0D\u8DB3\u4EE5\u8D2D\u4E70\u672C\u6B21\u7F51\u683C\uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*a.value+c.value).toFixed(2)}`);continue}k=e.openPrice,a.value=r(a.value+h),c.value=r(c.value-p),A.value.push(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u4E70\u5165 ${h} \u80A1 , \u652F\u51FA \uFFE5${p} \uFF0C \u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${c.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*a.value+c.value).toFixed(2)}`)}}}A.value.push(`\u5F53\u524D\u6301\u4ED3 ${a.value} \uFF0C  \u4F59\u989D \uFFE5${c.value}\uFF0C  \u5E02\u503C \uFFE5${(m[m.length-1].closePrice*a.value+c.value).toFixed(2)}`)}else ae.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},ve=async()=>{I.value=!1},V=async()=>{g.value=Y(),g.value.length>0?g.value.forEach(n=>J(`${n.market}.${n.code}`)):["1.000001","1.000300","1.000905","0.399006"].forEach(n=>J(n)),z&&(Z.value=setTimeout(()=>{V()},1e3*30))};return(()=>{V()})(),me(()=>{clearTimeout(Z.value)}),(n,o)=>{const v=Pe,m=Ce;return _(),S("div",Ie,[Ye,u("main",Je,[u("header",Ve,[ce?(_(),ye(v,{key:0,modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value=t),"inline-prompt":"","active-text":"\u9884","inactive-text":"\u56DE",onChange:le},null,8,["modelValue"])):te("",!0),u("div",He,[G(u("input",{class:"stock-search-input",type:"text",placeholder:"\u8BF7\u8F93\u5165\u80A1\u7968/\u57FA\u91D1\u4EE3\u7801","onUpdate:modelValue":o[1]||(o[1]=t=>l.value=t),onFocus:o[2]||(o[2]=t=>ee(!0)),onBlur:o[3]||(o[3]=t=>ee(!1)),onInput:re},null,544),[[Ee,l.value]]),G(u("div",null,[F.value&&F.value.length>0?(_(),S("ul",Te,[(_(!0),S(K,null,Q(F.value,t=>(_(),S("li",{key:`${t.MktNum}.${t.Code}_${t.Name}`,onClick:E=>Fe(`${t.MktNum}.${t.Code}`)},y(`${t.Code} ${t.Name} ${t.SecurityTypeName}`),9,Oe))),128))])):l.value.length>0?(_(),S("ul",Ue,Ge)):(_(),S("ul",Ke,qe))],512),[[ue,f.value]])])]),u("main",null,[g.value?(_(),S("div",We,[(_(!0),S(K,null,Q(g.value,(t,E)=>(_(),S("div",{key:E,class:"cus-table next-price"},[u("div",Xe,[u("div",je,[u("span",ze,y(`${t.code} ${t.name}`),1),q(m,{class:"btn-opt",type:"primary",icon:W(_e),circle:"",onClick:D=>he(`${t.market}.${t.code}`)},null,8,["icon","onClick"]),q(m,{class:"btn-opt",type:"danger",icon:W(Se),circle:"",onClick:D=>fe(t)},null,8,["icon","onClick"])])]),u("div",Ze,[et,u("div",{class:De(["cus-column close-price",{"close-price-red":t.nowPrice.closePrice>(t.nextPrice.firstSalePrice+t.nextPrice.firstBuyPrice)/2}])},"\u4EF7\u683C("+y(t.nowPrice.closePrice.toFixed(3))+")",3)]),u("div",tt,[ut,u("div",st,y(t.nextPrice.highSalePrice.toFixed(3))+"(+"+y(t.nextPrice.highSaleRate)+"%)",1)]),u("div",at,[nt,u("div",ot,y(t.nextPrice.firstSalePrice.toFixed(3))+"(+"+y(t.nextPrice.firstSaleRate)+"%)",1)]),u("div",ct,[it,u("div",lt,y(t.nextPrice.firstBuyPrice.toFixed(3))+"(-"+y(t.nextPrice.firstBuyRate)+"%)",1)]),u("div",rt,[dt,u("div",Ft,y(t.nextPrice.lowBuyPrice.toFixed(3))+"(-"+y(t.nextPrice.lowBuyRate)+"%)",1)]),u("div",ft,[ht,u("div",vt,y((t.nextPrice.firstSaleRate+t.nextPrice.firstBuyRate).toFixed(2))+"% - "+y((t.nextPrice.highSaleRate+t.nextPrice.lowBuyRate).toFixed(2))+"% ",1)])]))),128)),G(u("div",pt,[u("div",gt,[(_(!0),S(K,null,Q(A.value,(t,E)=>(_(),S("div",{key:E,class:"backtesting-log-item"},y(t),1))),128)),q(m,{type:"danger",icon:W(ke),onClick:ve},{default:Ae(()=>[mt]),_:1},8,["icon"])])],512),[[ue,I.value]])])):te("",!0)])]),Pt])}}});Be(Ct).mount("#app");
