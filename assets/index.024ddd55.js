import{f as Ce,d as me,r as C,c as ye,o as Ee,E as Ae,a as Se,b as A,e as a,g as _e,h as ae,w as q,v as De,i as ne,F as I,j as Y,u as J,k as W,l as j,m as Be,n as $e,p as m,t as y,q as xe,_ as ke,s as oe,x as we,y as ie,z as be,A as Me}from"./vendor.9f89fbdc.js";const Re=function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))h(c);new MutationObserver(c=>{for(const F of c)if(F.type==="childList")for(const p of F.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&h(p)}).observe(document,{childList:!0,subtree:!0});function l(c){const F={};return c.integrity&&(F.integrity=c.integrity),c.referrerpolicy&&(F.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?F.credentials="include":c.crossorigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function h(c){if(c.ep)return;c.ep=!0;const F=l(c);fetch(c.href,F)}};Re();var Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArlJREFUWEfFl1nITVEUx3/fE1GmF7wrGUvIECFCyVhEhpJSHlBIeEHCCzIkb5QhooyliBAZ4sWc8iZjMhXFC/2/9ql11rfPPfue6+uuOnXP2Wv47bWHtW4LTZaWJsenCkAXYCTQMzyaw8fw3Ad+1DOpVIDuwCpgNDC5JMBV4C6wH/haBpMCsAJYDfQtc+bGXwH7gEO17MoAzgGz6gzs1c8Ds4t81AJQ+ro1GDwz/wZoGdtIEcBJYP5/Cp65OQUs8D5jAJuBLUbxLHAAGAdMB4YmgMn+FrASmGP09X2rtfcAQ4A7QCejNAG4ad4F+MU8GuphHhtgPHDD2L4DhgHvs28eIJb6RcCJhFnHVBYCx91ALgsWQGQPI17WAbsrAqwFdjnbN0Af4I++W4BNwHan/BuYFJalCsMY4BrQwRkvAw57AK2V1syKZrCnSmRjsyaSQe0p7a1cBl4A/VywwcDTBgEGAU+cj5dAfw+gne0vC11E3xsE6AroIrKiS04nJ5eBn+74aby9AH4BnT2AToBOgpX2WoJHwHAPcBRY7ABUgnULNiK6DVWarRwDlniAjcAOp/gBGAu8rkig834b6OXsdeR3eoCZgEqnF5XkpRU2ozbfkYJSrBJ/wQPoXZ3MqAiEvus8P0jMxIhwf6iD8nIvdFat330tyO7u58A8YABw2nh4FshVWvXbysBQwpVJ/S6SXG2JleMroe/LICa6TXQRUJCYCHZujeDqF6fY8RiAar6CSC4D0wCVYF3Tj8NG/VQQRMdWOkUyA7hUBqBxbbrWYgFMBZSVVPlboKglPePHavWE6oT3BoPrwNvQ+68vIYkBRIPLT1lXrNSrLdefkEzKbCyAlkMlvs3MU51JrzewHNgAdEyAFoCKzzbgIKCeolDKZmMNM5BcUxnxrKwp8OeUTVMPQIq/unWaDvAPFJGAIVce/UQAAAAASUVORK5CYII=";function X(n,d){return Ce(n,d||{timeout:1e3*5,jsonpCallback:"cb"}).then(l=>l.json())}function Ie(n,d=1,l=10){const h=`https://searchapi.eastmoney.com/api/Info/Search?appid=el1902262&type=14&token=CCSDCZSDCXYMYZYYSYYXSMDDSMDHHDJT&and14=MultiMatch/Name,Code,PinYin/${n}/true&returnfields14=Name,Code,PinYin,MarketType,JYS,MktNum,JYS4App,MktNum4App,ID,Classify,IsExactMatch,SecurityType,SecurityTypeName&pageIndex14=${d}&pageSize14=${l}&isAssociation14=false1642753371132`;return X(h)}function le(n){return n&&n.data&&n.data.klines&&(n.data.klineDatas=n.data.klines.map(d=>{const l=d.split(","),h=l[0];let c=h,F="";return h.includes(" ")&&([c,F]=h.split(" ")),{dateStr:c,timeStr:F,openPrice:parseFloat(l[1]),closePrice:parseFloat(l[2]),highPrice:parseFloat(l[3]),lowPrice:parseFloat(l[4])}})),n}async function Ye(n){const d=`https://push2his.eastmoney.com/api/qt/stock/kline/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&beg=0&end=20500101&ut=fa5fd1943c7b386f172d6893dbfba10b&rtntype=6&secid=${n}&klt=5&fqt=1
  `,l=await X(d);return le(l)}async function Je(n,d){const l=`https://push2his.eastmoney.com/api/qt/stock/kline/get?secid=${n}&ut=fa5fd1943c7b386f172d6893dbfba10b&fields1=f1,f2,f3,f4,f5,f6&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&klt=101&fqt=0&end=20500101&lmt=${d}&_=${Date.now()}`,h=await X(l);return le(h)}function Oe(n,d){const l={"y+":n.getFullYear(),"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours()%12==0?12:n.getHours()%12,"H+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),"f+":n.getMilliseconds()};for(const h in l)new RegExp("("+h+")").test(d)&&(d=d.replace(RegExp.$1,l[h].toString().padStart(RegExp.$1.length,"0")));return d}function ce(n){return Oe(new Date,n)}function r(n=1,d=3){const l=Math.pow(10,d);return Math.round(n*l)/l}function z(n,d,l){const h=d-l,c=(n*2+l+d)/4,F=r(h+c),p=r(c*2-l),k=r(c*2-d),w=r(c-h);return{highSalePrice:F,highSaleRate:r((F/n-1)*100,2),firstSalePrice:p,firstSaleRate:r((p/n-1)*100,2),firstBuyPrice:k,firstBuyRate:r((n/k-1)*100,2),lowBuyPrice:w,lowBuyRate:r((n/w-1)*100,2)}}const Ve=a("header",null,[a("h1",{class:"flex-center"},[a("span",{class:"title"},"\u4EF7\u683C\u9884\u6D4B"),a("a",{class:"cursor-pointer",href:"https://github.com/adams549659584/grid-quant",target:"_blank"},[a("img",{src:Ne,alt:"https://github.com/adams549659584/grid-quant"})])])],-1),He={class:"flex-center space-x-4"},Te={class:"absolute"},Ue={key:0,class:"search-hotkey"},Le=["onClick"],Ge={key:1,class:"search-hotkey"},Ke=a("li",{class:"search-hotkey-items"},"\u6682\u65E0\u76F8\u5173\u80A1\u7968/\u57FA\u91D1",-1),Qe=[Ke],qe={key:2,class:"search-hotkey"},We=a("li",{class:"search-hotkey-items"},"\u8F93\u5165\u80A1\u7968/\u57FA\u91D1 \u7F16\u7801/\u7B80\u62FC/\u5168\u62FC/\u4E2D\u6587",-1),je=[We],Xe={key:0,class:"flex-center justify-around text-xl font-bold"},ze={class:"row p-2"},Ze={class:"flex-1 text-center truncate"},et={class:"row"},tt=a("div",{class:"column"},"\u64CD\u4F5C",-1),ut={class:"row bg-red-400"},st=a("div",{class:"column"},"\u6781\u9650\u83B7\u5229\u4F4D",-1),at={class:"column"},nt={class:"row bg-red-300"},ot=a("div",{class:"column"},"\u7B2C\u4E00\u538B\u529B\u4F4D",-1),it={class:"column"},lt={class:"row bg-green-300"},ct=a("div",{class:"column"},"\u7B2C\u4E00\u652F\u6491\u4F4D",-1),rt={class:"column"},dt={class:"row bg-green-400"},Ft=a("div",{class:"column"},"\u6781\u9650\u6284\u5E95\u4F4D",-1),ft={class:"column"},vt={class:"row"},ht=a("div",{class:"column"},"\u632F\u5E45",-1),pt={class:"column"},gt=["onClick"],Pt={class:"flex-center p-4"},Ct=we("\u770B\u5B8C\u4E86"),mt=a("footer",null,[a("div",{class:"p-4 text-gray-400"},[a("p",{class:"flex-center space-x-2"},[a("span",null,"MIT Licensed | Copyright \xA9 2022"),a("a",{href:"https://github.com/adams549659584",target:"_blank"},"adams549659584")])])],-1),yt=me({setup(n){const d="history_search_results",l=C(!0),h=C(!1),c=C(""),F=C(),p=C(),k=C(!1),w=Number(ce("Hmm")),Z=w>=930&&w<=1500,re=!Z,de=ye(()=>{if(!p.value||p.value.length===0)return 0;const t=p.value.length,s=window.screen.width;return s>=1536?5-t%5:s>=1280?4-t%4:s>=1024?3-t%3:s>=768?2-t%2:0}),M=.008,O=C(5),R=C(1e3),B=C(400),o=C(0),i=C(1e5),ee=C(0),Fe=C(""),V=C(!1),S=C([]),te=t=>{t?h.value=t:setTimeout(()=>{h.value=t},300)},fe=async()=>{U()},ve=async()=>{if(c.value){k.value=!0;const t=await Ie(c.value);F.value=t.Data||[],k.value=!1}else F.value=[]},H=()=>{const t=localStorage.getItem(d);return t?JSON.parse(t):[]},he=t=>{let s=H();const f=s.findIndex(g=>t.market===g.market&&t.code===g.code&&t.name===g.name);f>-1?s[f]=t:s=[t,...s],p.value=s,localStorage.setItem(d,JSON.stringify(s))},pe=async t=>(S.value.push("selectChange : ",t),Fe.value=t,T(t)),T=async t=>{const s=await Je(t,2);if(s&&s.data&&s.data.klineDatas&&s.data.klineDatas.length===2){const f=s.data.klineDatas,g=ce("yyyy-MM-dd"),e=!l.value||f[1].dateStr===g&&new Date().getHours()<15?f[0]:f[1],E=z(e.closePrice,e.highPrice,e.lowPrice),D=r((E.highSalePrice-E.lowBuyPrice)/((E.highSalePrice+E.lowBuyPrice)/2),2);r(D/O.value),he({market:s.data.market,code:s.data.code,name:s.data.name,nowPrice:f[1],nextPrice:E})}else ie.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},ge=t=>{let s=H();s=s.filter(f=>!(t.market===f.market&&t.code===f.code&&t.name===f.name)),p.value=s,localStorage.setItem(d,JSON.stringify(s))},Pe=async t=>{const s=be.service({lock:!0}),f=await Ye(t);if(s.close(),f&&f.data&&f.data.klineDatas&&f.data.klineDatas.length>0){V.value=!0,S.value=[],o.value=0,i.value=1e5,S.value.push(`\u521D\u59CB\u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value}`);const g=f.data.klineDatas,e=g[0];let E=e.dateStr,D=e.highPrice,b=e.lowPrice,N=e.closePrice,P=z(N,D,b),L=r((P.firstSalePrice-P.firstBuyPrice)/((P.firstSalePrice+P.firstBuyPrice)/2),2),x=r(L/O.value);x<M&&(x=M),B.value=Math.round(2e3/N/100)*100,B.value===0&&(B.value=100),R.value=B.value*2;let G=e.openPrice,$=G;for(let K=1;K<g.length;K++){const u=g[K];if(E===u.dateStr?(u.highPrice>D&&(D=u.highPrice),u.lowPrice<b&&(b=u.lowPrice),N=u.closePrice):(E=u.dateStr,G=u.openPrice,$=G,P=z(N,D,b),D=u.highPrice,b=u.lowPrice,L=r((P.firstSalePrice-P.firstBuyPrice)/((P.firstSalePrice+P.firstBuyPrice)/2),2),x=r(L/O.value),x<M&&(x=M)),o.value<R.value&&u.openPrice>P.firstBuyPrice&&u.openPrice<P.firstSalePrice){const v=R.value-o.value,_=r(v*u.openPrice,2);if($=u.openPrice,i.value<_){S.value.push(`${u.dateStr} ${u.timeStr}\uFF1A\uFFE5${u.openPrice} \u4F59\u989D \uFFE5${i.value} \u4E0D\u8DB3\u4EE5\u5EFA\u4ED3${v}\uFF0C \u5E02\u503C\uFFE5 ${(u.openPrice*o.value+i.value).toFixed(2)}`);continue}o.value=r(o.value+v),i.value=r(i.value-_),S.value.push(`${u.dateStr} ${u.timeStr}\uFF1A \u4F4E\u4E8E\u6700\u5C0F\u6301\u4ED3\uFF0C\uFFE5${u.openPrice} \u4E70\u5165 ${v} \u80A1 , \u652F\u51FA \uFFE5${_} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C \uFFE5${(u.closePrice*o.value+i.value).toFixed(2)}`)}const Q=u.openPrice/$-1;if(Math.abs(Q)>x){if(o.value>0&&u.openPrice>P.highSalePrice){const v=o.value,_=r(v*u.openPrice,2);$=u.openPrice,o.value=r(o.value-v),i.value=r(i.value+_),S.value.push(`${u.dateStr} ${u.timeStr}\uFF1A\uFFE5${u.openPrice} \u6B62\u76C8\u5356\u51FA ${v} \u80A1 , \u6536\u5165 \uFFE5${_} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C \uFFE5${(u.openPrice*o.value+i.value).toFixed(2)}`)}else if(o.value>0&&u.openPrice<P.lowBuyPrice)if(u.openPrice<P.lowBuyPrice*.98){const v=o.value,_=r(v*u.openPrice,2);$=u.openPrice,o.value=r(o.value-v),i.value=r(i.value+_),S.value.push(`${u.dateStr} ${u.timeStr}\uFF1A\uFFE5${u.openPrice} \u6B62\u635F\u5356\u51FA ${v} \u80A1 , \u6536\u5165 \uFFE5${_} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C \uFFE5${(u.openPrice*o.value+i.value).toFixed(2)}`)}else{const v=ue(u,B.value*2);if(v.isSuccess)$=v.lastOptPrice;else continue}else if(Q>0&&o.value-B.value>=R.value){const v=B.value,_=r(v*u.openPrice,2);$=u.openPrice,o.value=r(o.value-v),i.value=r(i.value+_),S.value.push(`${u.dateStr} ${u.timeStr}\uFF1A\uFFE5${u.openPrice} \u7F51\u683C\u5356\u51FA ${v} \u80A1 , \u6536\u5165 \uFFE5${_} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C\uFFE5 ${(u.openPrice*o.value+i.value).toFixed(2)}`)}else if(Q<0&&u.openPrice>P.lowBuyPrice){const v=ue(u,B.value);if(v.isSuccess)$=v.lastOptPrice;else continue}}}S.value.push(`\u5F53\u524D\u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value}\uFF0C  \u5E02\u503C \uFFE5${(g[g.length-1].closePrice*o.value+i.value).toFixed(2)}`)}else ie.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},ue=(t,s)=>{const f=r(s*t.openPrice,2);return i.value<f?(S.value.push(`${t.dateStr} ${t.timeStr}\uFF1A\uFFE5${t.openPrice} \u4F59\u989D \uFFE5${i.value} \u4E0D\u8DB3\u4EE5\u8D2D\u4E70\u672C\u6B21\u7F51\u683C\uFF0C \u5E02\u503C\uFFE5 ${(t.openPrice*o.value+i.value).toFixed(2)}`),{isSuccess:!1,lastOptPrice:0}):(o.value=r(o.value+s),i.value=r(i.value-f),S.value.push(`${t.dateStr} ${t.timeStr}\uFF1A\uFFE5${t.openPrice} \u7F51\u683C\u4E70\u5165 ${s} \u80A1 , \u652F\u51FA \uFFE5${f} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${i.value} \uFF0C \u5E02\u503C\uFFE5 ${(t.openPrice*o.value+i.value).toFixed(2)}`),{isSuccess:!0,lastOptPrice:t.openPrice})},se=async()=>{V.value=!1},U=async()=>{p.value=H(),p.value.length>0?p.value.forEach(t=>T(`${t.market}.${t.code}`)):["1.510050","0.159602","1.561990","1.510500","1.512100","1.516970","0.159928","1.512670","1.512660","1.516110","1.512000","1.512480","1.516160","1.515030","1.515790","0.159867","0.159790","1.512760","1.516100","0.159997","0.159755","1.512980","0.159828","1.512170","0.159883","1.513050","1.513330","0.159967","0.159745","1.512200","0.159825","0.159996","0.159992","1.515250","1.516780","1.516150","1.511220","1.511260","0.159905","1.511380","1.513500","0.161834","1.501022","0.159981","1.512890","1.512690","1.513100","1.513300"].forEach(t=>T(t)),Z&&(ee.value=setTimeout(()=>{U()},1e3*30))};return(()=>{U()})(),Ee(()=>{clearTimeout(ee.value)}),(t,s)=>{const f=Ae,g=Se;return m(),A("div",null,[Ve,a("main",null,[a("header",He,[re?(m(),_e(f,{key:0,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),"inline-prompt":"","active-text":"\u9884","inactive-text":"\u56DE",onChange:fe},null,8,["modelValue"])):ae("",!0),a("div",null,[q(a("input",{class:"input-search",type:"text",placeholder:"\u8BF7\u8F93\u5165\u80A1\u7968/\u57FA\u91D1\u4EE3\u7801","onUpdate:modelValue":s[1]||(s[1]=e=>c.value=e),onFocus:s[2]||(s[2]=e=>te(!0)),onBlur:s[3]||(s[3]=e=>te(!1)),onInput:ve},null,544),[[De,c.value]]),q(a("div",Te,[F.value&&F.value.length>0?(m(),A("ul",Ue,[(m(!0),A(I,null,Y(F.value,e=>(m(),A("li",{class:"search-hotkey-items",key:`${e.MktNum}.${e.Code}_${e.Name}`,onClick:E=>pe(`${e.MktNum}.${e.Code}`)},y(`${e.Code} ${e.Name} ${e.SecurityTypeName}`),9,Le))),128))])):c.value.length>0?(m(),A("ul",Ge,Qe)):(m(),A("ul",qe,je))],512),[[ne,h.value]])])]),a("main",null,[p.value?(m(),A("div",Xe,[(m(!0),A(I,null,Y(p.value,(e,E)=>(m(),A("div",{class:"next-price-box",key:E},[a("div",ze,[a("span",Ze,y(`${e.code} ${e.name}`),1),j(g,{class:"w-min",type:"primary",icon:J(xe),circle:"",onClick:D=>Pe(`${e.market}.${e.code}`)},null,8,["icon","onClick"]),j(g,{class:"w-min",type:"danger",icon:J(ke),circle:"",onClick:D=>ge(e)},null,8,["icon","onClick"])]),a("div",et,[tt,a("div",{class:oe(["column close-price-green",{"close-price-red":e.nowPrice.closePrice>=(e.nextPrice.firstSalePrice+e.nextPrice.firstBuyPrice)/2}])}," \u4EF7\u683C("+y(e.nowPrice.closePrice.toFixed(3))+") ",3)]),a("div",ut,[st,a("div",at,y(e.nextPrice.highSalePrice.toFixed(3))+"(+"+y(e.nextPrice.highSaleRate.toFixed(2))+"%)",1)]),a("div",nt,[ot,a("div",it,y(e.nextPrice.firstSalePrice.toFixed(3))+"(+"+y(e.nextPrice.firstSaleRate.toFixed(2))+"%)",1)]),a("div",lt,[ct,a("div",rt,y(e.nextPrice.firstBuyPrice.toFixed(3))+"(-"+y(e.nextPrice.firstBuyRate.toFixed(2))+"%)",1)]),a("div",dt,[Ft,a("div",ft,y(e.nextPrice.lowBuyPrice.toFixed(3))+"(-"+y(e.nextPrice.lowBuyRate.toFixed(2))+"%)",1)]),a("div",vt,[ht,a("div",pt,y((e.nextPrice.firstSaleRate+e.nextPrice.firstBuyRate).toFixed(2))+"% - "+y((e.nextPrice.highSaleRate+e.nextPrice.lowBuyRate).toFixed(2))+"% ",1)])]))),128)),(m(!0),A(I,null,Y(J(de),e=>(m(),A("div",{class:"next-price-box invisible",key:e}))),128)),q(a("div",{class:"backtesting-log-bg",onClick:W(se,["stop"])},[a("div",{class:"backtesting-log-box",onClick:s[4]||(s[4]=W(()=>{},["stop"]))},[(m(!0),A(I,null,Y(S.value,(e,E)=>(m(),A("div",{class:oe(["backtesting-log-item",{"log-buy":e.includes("\u7F51\u683C\u4E70\u5165"),"log-sale":e.includes("\u7F51\u683C\u5356\u51FA"),"log-stop-profit":e.includes("\u6B62\u76C8\u5356\u51FA"),"log-stop-loss":e.includes("\u6B62\u635F\u5356\u51FA")}]),key:E},y(e),3))),128)),a("div",Pt,[j(g,{type:"danger",icon:J($e),onClick:W(se,["stop"])},{default:Be(()=>[Ct]),_:1},8,["icon","onClick"])])])],8,gt),[[ne,V.value]])])):ae("",!0)])]),mt])}}});Me(yt).mount("#app");
