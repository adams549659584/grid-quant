import{f as ie,d as re,r as y,c as de,o as Fe,E as fe,a as pe,b as he,e as ve,g as x,h as s,u as q,i as z,j as W,k as U,w as X,F as j,l as Z,m as ee,n as G,p as ge,q as D,t as C,_ as me,s as Pe,v as Ce}from"./vendor.e013daa3.js";const Ee=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))f(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const E of d.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&f(E)}).observe(document,{childList:!0,subtree:!0});function n(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerpolicy&&(d.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?d.credentials="include":i.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function f(i){if(i.ep)return;i.ep=!0;const d=n(i);fetch(i.href,d)}};Ee();var ye="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArlJREFUWEfFl1nITVEUx3/fE1GmF7wrGUvIECFCyVhEhpJSHlBIeEHCCzIkb5QhooyliBAZ4sWc8iZjMhXFC/2/9ql11rfPPfue6+uuOnXP2Wv47bWHtW4LTZaWJsenCkAXYCTQMzyaw8fw3Ad+1DOpVIDuwCpgNDC5JMBV4C6wH/haBpMCsAJYDfQtc+bGXwH7gEO17MoAzgGz6gzs1c8Ds4t81AJQ+ro1GDwz/wZoGdtIEcBJYP5/Cp65OQUs8D5jAJuBLUbxLHAAGAdMB4YmgMn+FrASmGP09X2rtfcAQ4A7QCejNAG4ad4F+MU8GuphHhtgPHDD2L4DhgHvs28eIJb6RcCJhFnHVBYCx91ALgsWQGQPI17WAbsrAqwFdjnbN0Af4I++W4BNwHan/BuYFJalCsMY4BrQwRkvAw57AK2V1syKZrCnSmRjsyaSQe0p7a1cBl4A/VywwcDTBgEGAU+cj5dAfw+gne0vC11E3xsE6AroIrKiS04nJ5eBn+74aby9AH4BnT2AToBOgpX2WoJHwHAPcBRY7ABUgnULNiK6DVWarRwDlniAjcAOp/gBGAu8rkig834b6OXsdeR3eoCZgEqnF5XkpRU2ozbfkYJSrBJ/wQPoXZ3MqAiEvus8P0jMxIhwf6iD8nIvdFat330tyO7u58A8YABw2nh4FshVWvXbysBQwpVJ/S6SXG2JleMroe/LICa6TXQRUJCYCHZujeDqF6fY8RiAar6CSC4D0wCVYF3Tj8NG/VQQRMdWOkUyA7hUBqBxbbrWYgFMBZSVVPlboKglPePHavWE6oT3BoPrwNvQ+68vIYkBRIPLT1lXrNSrLdefkEzKbCyAlkMlvs3MU51JrzewHNgAdEyAFoCKzzbgIKCeolDKZmMNM5BcUxnxrKwp8OeUTVMPQIq/unWaDvAPFJGAIVce/UQAAAAASUVORK5CYII=";function K(u,l){return ie(u,l||{timeout:1e3*5,jsonpCallback:"cb"}).then(n=>n.json())}function Ae(u,l=1,n=10){const f=`https://searchapi.eastmoney.com/api/Info/Search?appid=el1902262&type=14&token=CCSDCZSDCXYMYZYYSYYXSMDDSMDHHDJT&and14=MultiMatch/Name,Code,PinYin/${u}/true&returnfields14=Name,Code,PinYin,MarketType,JYS,MktNum,JYS4App,MktNum4App,ID,Classify,IsExactMatch,SecurityType,SecurityTypeName&pageIndex14=${l}&pageSize14=${n}&isAssociation14=false1642753371132`;return K(f)}function te(u){return u&&u.data&&u.data.klines&&(u.data.klineDatas=u.data.klines.map(l=>{const n=l.split(","),f=n[0];let i=f,d="";return f.includes(" ")&&([i,d]=f.split(" ")),{dateStr:i,timeStr:d,openPrice:parseFloat(n[1]),closePrice:parseFloat(n[2]),highPrice:parseFloat(n[3]),lowPrice:parseFloat(n[4])}})),u}async function _e(u){const l=`https://push2his.eastmoney.com/api/qt/stock/kline/get?fields1=f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&beg=0&end=20500101&ut=fa5fd1943c7b386f172d6893dbfba10b&rtntype=6&secid=${u}&klt=5&fqt=1
  `,n=await K(l);return te(n)}async function Se(u,l){const n=`https://push2his.eastmoney.com/api/qt/stock/kline/get?secid=${u}&ut=fa5fd1943c7b386f172d6893dbfba10b&fields1=f1,f2,f3,f4,f5,f6&fields2=f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61&klt=101&fqt=0&end=20500101&lmt=${l}&_=${Date.now()}`,f=await K(n);return te(f)}function De(u,l){const n={"y+":u.getFullYear(),"M+":u.getMonth()+1,"d+":u.getDate(),"h+":u.getHours()%12==0?12:u.getHours()%12,"H+":u.getHours(),"m+":u.getMinutes(),"s+":u.getSeconds(),"q+":Math.floor((u.getMonth()+3)/3),"f+":u.getMilliseconds()};for(const f in n)new RegExp("("+f+")").test(l)&&(l=l.replace(RegExp.$1,n[f].toString().padStart(RegExp.$1.length,"0")));return l}function ue(u){return De(new Date,u)}function c(u=1,l=3){const n=Math.pow(10,l);return Math.round(u*n)/n}function L(u,l,n){const f=l-n,i=(u*2+n+l)/4,d=c(f+i),E=c(i*2-n),B=c(i*2-l),k=c(i-f);return{highSalePrice:d,highSaleRate:c((d/u-1)*100,2),firstSalePrice:E,firstSaleRate:c((E/u-1)*100,2),firstBuyPrice:B,firstBuyRate:c((u/B-1)*100,2),lowBuyPrice:k,lowBuyRate:c((u/k-1)*100,2)}}const $e={class:"container"},Be=s("header",{class:"header"},[s("h1",{class:"flex-center"},[s("span",null,"\u4EF7\u683C\u9884\u6D4B"),s("a",{class:"flex-center",href:"https://github.com/adams549659584/grid-quant",target:"_blank"},[s("img",{class:"github-link",src:ye,alt:"https://github.com/adams549659584/grid-quant"})])])],-1),ke={class:"main"},xe={class:"search"},be=ee("\u56DE\u6D4B"),we={key:0,class:"next-price-box clear"},Me={class:"cus-row cus-row-header"},Ne={class:"cus-column"},Re={class:"stock-name"},Ie={class:"cus-row cus-row-header"},Ve=s("div",{class:"cus-column"},"\u64CD\u4F5C",-1),Ye={class:"cus-row high-sale-price"},Je=s("div",{class:"cus-column"},"\u6781\u9650\u83B7\u5229\u4F4D",-1),He={class:"cus-column"},Oe={class:"cus-row first-sale-price"},Te=s("div",{class:"cus-column"},"\u7B2C\u4E00\u538B\u529B\u4F4D",-1),Ue={class:"cus-column"},Ge={class:"cus-row first-buy-price"},Ke=s("div",{class:"cus-column"},"\u7B2C\u4E00\u652F\u6491\u4F4D",-1),Le={class:"cus-column"},Qe={class:"cus-row low-buy-price"},qe=s("div",{class:"cus-column"},"\u6781\u9650\u6284\u5E95\u4F4D",-1),ze={class:"cus-column"},We={class:"cus-row"},Xe=s("div",{class:"cus-column"},"\u632F\u5E45",-1),je={class:"cus-column"},Ze=s("footer",{class:"footer"},[s("div",null,[s("p",{class:"text"},[ee(" MIT Licensed | Copyright \xA9 2022 "),s("a",{href:"https://github.com/adams549659584",target:"_blank"},"adams549659584")])])],-1),et=re({setup(u){const l="history_search_results",n=y(!0),f=y(""),i=y(),d=y(),E=y(!1),B=Number(ue("Hmm")),k=B>=930&&B<=1500,b=.008,M=y(5),N=y(1e3),R=y(400),o=y(0),r=y(1e5),Q=y(0),w=de(()=>f.value?f.value.split("_")[0]:""),ae=async()=>{Y()},se=async F=>{if(F){E.value=!0;const a=await Ae(F);i.value=a.Data||[],E.value=!1}else i.value=[]},I=()=>{const F=localStorage.getItem(l);return F?JSON.parse(F):[]},oe=F=>{let a=I();const p=a.findIndex(P=>F.market===P.market&&F.code===P.code&&F.name===P.name);p>-1?a[p]=F:a=[F,...a],d.value=a,localStorage.setItem(l,JSON.stringify(a))},ne=async()=>{if(!!w.value)return V(w.value)},V=async F=>{const a=await Se(F,2);if(a&&a.data&&a.data.klineDatas&&a.data.klineDatas.length===2){const p=a.data.klineDatas,P=ue("yyyy-MM-dd"),A=!n.value||p[1].dateStr===P&&new Date().getHours()<15?p[0]:p[1],g=L(A.closePrice,A.highPrice,A.lowPrice),t=c((g.highSalePrice-g.lowBuyPrice)/((g.highSalePrice+g.lowBuyPrice)/2),2);c(t/M.value),oe({market:a.data.market,code:a.data.code,name:a.data.name,nowPrice:p[1],nextPrice:g})}else G.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},ce=F=>{let a=I();a=a.filter(p=>!(F.market===p.market&&F.code===p.code&&F.name===p.name)),d.value=a,localStorage.setItem(l,JSON.stringify(a))},le=async()=>{if(!w.value){G.error("\u8BF7\u5148\u9009\u62E9\u80A1\u7968/\u57FA\u91D1");return}const F=ge.service({lock:!0}),a=await _e(w.value);if(a&&a.data&&a.data.klineDatas&&a.data.klineDatas.length>0){o.value=0,r.value=1e5,console.log(`\u521D\u59CB\u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${r.value}`);const p=a.data.klineDatas,P=p[0];let A=P.dateStr,g=P.highPrice,t=P.lowPrice,$=P.closePrice,v=L($,g,t),J=c((v.firstSalePrice-v.firstBuyPrice)/((v.firstSalePrice+v.firstBuyPrice)/2),2),_=c(J/M.value);_<b&&(_=b);let H=P.openPrice,S=H;for(let O=1;O<p.length;O++){const e=p[O];if(A===e.dateStr?(e.highPrice>g&&(g=e.highPrice),e.lowPrice<t&&(t=e.lowPrice),$=e.closePrice):(console.log(`\u5B9E\u9645 : highPrice : ${g} , lowPrice : ${t} , closePrice : ${$}`),A=e.dateStr,console.log(`${A} :`),H=e.openPrice,S=H,v=L($,g,t),console.log("\u9884\u6D4B : ",v),g=e.highPrice,t=e.lowPrice,J=c((v.firstSalePrice-v.firstBuyPrice)/((v.firstSalePrice+v.firstBuyPrice)/2),2),_=c(J/M.value),_<b&&(_=b),console.log(`\u7F51\u683C\u5E45\u5EA6 : ${(_*100).toFixed(2)}%`)),o.value<N.value&&e.openPrice>v.firstBuyPrice&&e.openPrice<v.firstSalePrice){const h=N.value-o.value,m=c(h*e.openPrice,2);S=e.openPrice,o.value=c(o.value+h),r.value=c(r.value-m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A \u4F4E\u4E8E\u6700\u5C0F\u6301\u4ED3\uFF0C\uFFE5${e.openPrice} \u4E70\u5165 ${h} \u80A1 , \u652F\u51FA \uFFE5${m} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C \uFFE5${(e.closePrice*o.value+r.value).toFixed(2)}`)}const T=e.openPrice/S-1;if(Math.abs(T)>_){if(o.value>0&&e.openPrice>v.highSalePrice){const h=o.value,m=c(h*e.openPrice,2);S=e.openPrice,o.value=c(o.value-h),r.value=c(r.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u76C8\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*o.value+r.value).toFixed(2)}`)}else if(o.value>0&&e.openPrice<v.lowBuyPrice){const h=o.value,m=c(h*e.openPrice,2);S=e.openPrice,o.value=c(o.value-h),r.value=c(r.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u6B62\u635F\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C \uFFE5${(e.openPrice*o.value+r.value).toFixed(2)}`)}else if(T>0&&o.value-R.value>=N.value){const h=R.value,m=c(h*e.openPrice,2);S=e.openPrice,o.value=c(o.value-h),r.value=c(r.value+m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u5356\u51FA ${h} \u80A1 , \u6536\u5165 \uFFE5${m} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*o.value+r.value).toFixed(2)}`)}else if(T<0&&e.openPrice>v.lowBuyPrice){const h=R.value,m=c(h*e.openPrice,2);if(r.value<m){console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u4F59\u989D \uFFE5${r.value} \u4E0D\u8DB3\u4EE5\u8D2D\u4E70\u672C\u6B21\u7F51\u683C\uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*o.value+r.value).toFixed(2)}`);continue}S=e.openPrice,o.value=c(o.value+h),r.value=c(r.value-m),console.log(`${e.dateStr} ${e.timeStr}\uFF1A\uFFE5${e.openPrice} \u7F51\u683C\u4E70\u5165 ${h} \u80A1 , \u652F\u51FA \uFFE5${m} \uFF0C \u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${r.value} \uFF0C \u5E02\u503C\uFFE5 ${(e.openPrice*o.value+r.value).toFixed(2)}`)}}}console.log(`\u5F53\u524D\u6301\u4ED3 ${o.value} \uFF0C  \u4F59\u989D \uFFE5${r.value}\uFF0C  \u5E02\u503C \uFFE5${(p[p.length-1].closePrice*o.value+r.value).toFixed(2)}`),F.close()}else G.error("\u83B7\u53D6K\u7EBF\u6570\u636E\u5F02\u5E38")},Y=async()=>{d.value=I(),d.value.length>0?d.value.forEach(F=>V(`${F.market}.${F.code}`)):["1.000001","1.000300","1.000905","0.399006"].forEach(F=>V(F)),k&&(Q.value=setTimeout(()=>{Y()},1e3*30))};return(()=>{Y()})(),Fe(()=>{clearTimeout(Q.value)}),(F,a)=>{const p=fe,P=pe,A=he,g=ve;return D(),x("div",$e,[Be,s("main",ke,[s("header",xe,[q(k)?W("",!0):(D(),z(p,{key:0,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),"inline-prompt":"","active-text":"\u9884","inactive-text":"\u56DE",onChange:ae},null,8,["modelValue"])),U(A,{class:"stock-selelct",size:"large",modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=t=>f.value=t),clearable:!0,filterable:"",remote:"","reserve-keyword":"",placeholder:"\u8BF7\u9009\u62E9\u80A1\u7968/\u57FA\u91D1","remote-method":se,loading:E.value,onChange:ne},{default:X(()=>[(D(!0),x(j,null,Z(i.value,t=>(D(),z(P,{key:`${t.MktNum}.${t.Code}_${t.Name}`,label:`${t.Code} ${t.Name} ${t.SecurityTypeName}`,value:`${t.MktNum}.${t.Code}_${t.Name}`},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),U(g,{class:"btn-backtesting",size:"large",type:"danger",onClick:le},{default:X(()=>[be]),_:1})]),s("main",null,[d.value?(D(),x("div",we,[(D(!0),x(j,null,Z(d.value,(t,$)=>(D(),x("div",{key:$,class:"cus-table next-price"},[s("div",Me,[s("div",Ne,[s("span",Re,C(`${t.code} ${t.name}`),1),U(g,{class:"btn-delete",type:"danger",icon:q(me),circle:"",onClick:v=>ce(t)},null,8,["icon","onClick"])])]),s("div",Ie,[Ve,s("div",{class:Pe(["cus-column close-price",{"close-price-red":t.nowPrice.closePrice>(t.nextPrice.firstSalePrice+t.nextPrice.firstBuyPrice)/2}])},"\u4EF7\u683C("+C(t.nowPrice.closePrice.toFixed(3))+")",3)]),s("div",Ye,[Je,s("div",He,C(t.nextPrice.highSalePrice.toFixed(3))+"(+"+C(t.nextPrice.highSaleRate)+"%)",1)]),s("div",Oe,[Te,s("div",Ue,C(t.nextPrice.firstSalePrice.toFixed(3))+"(+"+C(t.nextPrice.firstSaleRate)+"%)",1)]),s("div",Ge,[Ke,s("div",Le,C(t.nextPrice.firstBuyPrice.toFixed(3))+"(-"+C(t.nextPrice.firstBuyRate)+"%)",1)]),s("div",Qe,[qe,s("div",ze,C(t.nextPrice.lowBuyPrice.toFixed(3))+"(-"+C(t.nextPrice.lowBuyRate)+"%)",1)]),s("div",We,[Xe,s("div",je,C((t.nextPrice.firstSaleRate+t.nextPrice.firstBuyRate).toFixed(2))+"% - "+C((t.nextPrice.highSaleRate+t.nextPrice.lowBuyRate).toFixed(2))+"% ",1)])]))),128))])):W("",!0)])]),Ze])}}});Ce(et).mount("#app");
